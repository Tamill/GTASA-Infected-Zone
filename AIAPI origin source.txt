{$CLEO .cs}
thread 'TAMAI' 
0000: This is TAMAI Start    All Code made by Tamill (Tamcl)  ���׶��ű�С�� Email: newtamcl@163.com   
goto @TAMAI_Global_Start_Thread
0662: printstring "CLEO by Tamcl"
0662: printstring "Email: newtmacl@foxmail.com or newtamc@163.com"


  
const
 ai_type_locked = 5
 ai_type_killer = 4
 ai_type_friend = 2
 ai_type_stayer = 1
 group_friend = -15
 group_ped = 0
 group_police = -20
 group_enemy1 = -10
 group_enemy2 = -11
 group_enemy3 = -12
 group_enemy4 = -13
 group_enemy5 = -14
 group_friend = -15
 group_ballas1 = -18
 group_ballas2 = -19
 group_familly = -21
 clean_like_ped = 1
 never_clean = 0
 clean_like_ped_when_mission_end = 2
 clean_like_ped_and_die_remove = 3
 clean_far_ped = 4 
 no_group = 0
 group_player = 1
 group_one = 1 //actor_id
 group_player_but_no_following = 2
 police_system_standby = 0
end // const

const
 ai_id = 0@
 ai_clean_type = 1@
 ai_type = 2@
 ai_group_type = 3@
 ai_master_ped = 4@
 ai_taskpack = 5@
 ai_data0 = 6@
 ai_data1 = 7@
 ai_data2 = 8@
 ai_data3 = 9@
 ai_data4 = 10@
 ai_data5 = 11@
 ai_data6 = 12@
 function_character_current_task_id = 13@
 ai_get_closest_target_id = 14@
 ai_get_closest_target_ped = 15@
 ai_get_closest_target_ped2 = 16@
 ai_get_closest_target_memory = 17@
 special_command = 18@ 
 tick_time = 32@
 ai_target = 20@ 
 ai_marker = 21@
 ai_maker = 22@
 ai_point_x = 23@
 ai_point_y = 24@
 ai_point_z = 25@
 next_get_target_wait = 26@
 AI_next_shoot_wait = 27@
 ai_cover_object = 28@
 ai_object = 29@
 
 ai_move_time = 19@

end // const
const
 AI_TASK_PACK = 37
 AI_TASK_MAKER = 38
 ai_task_aiming = 39
 ai_task_firing = 40
 ai_task_fighting = 41
 ai_task_go_to_target = 42
 ai_task_go_to_target_in_car = 43
 function_character_search_shelter_1 = 44
 function_character_search_shelter_2 = 45
 function_character_search_shelter_3 = 49
 function_character_search_shelter_4 = 48
 ai_playing_task_pack = 152
 ai_idle_1 = 155
 ai_idle_2 = 156
 ai_idle_3 = 157
 ai_entering_leader_car = 200
 ai_in_leader_car = 201
 ai_running_away = 252
 ai_swimming_water_height = 0.25
 
 speed_ai_move_with_shooting = 3.0
end // const

const 
    ped_event_handsup = 1476
    ped_event_walkpath = 1502
end


0662: printstring "CLEO by Tamcl"
0662: printstring "Email: 1298878474@qq.com or newtamc@163.com"
0662: "��������������AI  The Combat artificial intelligence"
0662: "��ϵͳ��Tamcl���� The system made by Tamcl"
0662: "�κ��˲���δ����������޸�/ת��  Anyone without permission can not modify or reprint."
0662: "QQ: 1298878474"



 
:TAMAI_Awake           
if and
   $get_version_dec > 0.00
   $get_version_dec < 10.00
then
    $current_threads += 1
    $current_humans += 1 

end
gosub @check_character_defined   
gosub @check_character_dead      
gosub @script_add_necessary_sub_object 
gosub @function_reset_plane                          




 
:TAMAI_Update
gosub @clean_temporary_global_variable
wait 0
if  
    player.Defined($PLAYER_CHAR)
jf @TAMAI_Update
if  
    056D:   actor $PLAYER_ACTOR defined
jf @TAMAI_Update
gosub @check_character_defined     
gosub @function_character_set_animation_rate
gosub @check_character_dead     
gosub @read_external_script_command_01
gosub @check_character_defined      

if 
    gosub @function_character_enter_interior
jf @TAMAI_Update
gosub @function_character_remove_as_ped       
gosub @function_character_remove_as_mission_actor  
gosub @function_character_remove_when_far_away
if
   not $Disable_AI == true
jf @TAMAI_Update   
if
     gosub @check_character_is_not_be_hit
jf @TAMAI_Update                               
if 
    gosub @check_character_is_not_on_car_task
jf @TAMAI_Update
if
    gosub @check_character_is_not_climbing
jf @TAMAI_Update
if 
    gosub @function_character_climb_obstacle
jf @TAMAI_Update
if 
    gosub @function_character_follow_the_master
jf @TAMAI_Update
if 
    gosub @function_character_in_player_group
jf @TAMAI_Update
if 
    gosub @function_character_peripheral_response
jf @TAMAI_Update
if 
    gosub @function_character_idle_animation
jf @TAMAI_Update
if 
    gosub @function_character_attack_players_target  
jf @TAMAI_Update
if 
    gosub @function_character_avoid_dangerous_goods
jf @TAMAI_Update

gosub @listener_target_detector_start      
 goto @listener_detector_foreach_in_world_npcs      

:listener_detector_found_target
goto  @listener_detector_can_character_kill           

:listener_detector_can_character_kill_success
goto @listener_detector_is_nearer_than_before              
goto @listener_detector_foreach_next 

:listener_detector_get_target_completed

                                  
if 
    gosub @check_target_character_defined
then
    if  ai_taskpack == -2
    then
        02A9: set_actor ai_target immune_to_nonplayer 0

    end
    if
         gosub @function_character_drive_tank 
    jf @TAMAI_Update 
    if  
        gosub @check_character_current_wepaon_can_shoot
    then
        if
             gosub @function_character_fire_weapon_in_car  
        jf @TAMAI_Update 
        gosub @script_get_this_moving_tick_time
        if 
            001D:   $TEMPVAR_FLOAT_1 > $TEMPVAR_FLOAT_2  // (int)
        then
            gosub @script_get_this_postion_water_high
            if and 
                not Actor.Driving(0@)
                8025: not  ai_data4 > $TEMPVAR_FLOAT_3  // (float)
            then 
                if  
                    gosub @check_target_can_character_shoot
                then
                    if  
                        0104:   actor 0@ near_actor ai_target radius 60.0 60.0 60.0 sphere 0 
                    then
                        if  
                            gosub @function_character_search_shelter
                        jf @TAMAI_Update                   
                        if  
                            gosub @function_character_search_shelter2
                        jf @TAMAI_Update 
                        if  
                            gosub @function_character_search_shelter3
                        jf @TAMAI_Update
                        if 
                            gosub @function_character_chases_the_target
                        jf @TAMAI_Update   
                                      
                        if 
                            gosub @function_character_fallback_when_target_closes
                        jf @TAMAI_Update 
                        if 
                            gosub @function_character_find_car_to_kill_target
                        jf @TAMAI_Update 
                        if and
                            not function_character_current_task_id == function_character_search_shelter_1
                            not function_character_current_task_id == function_character_search_shelter_2
                            not function_character_current_task_id == function_character_search_shelter_3
                            not function_character_current_task_id == function_character_search_shelter_4
                        then
                            062E: get_actor 0@ task 1506 status_store_to $TEMPVAR_FLOAT_2 // ret 7 if not found
                            062E: get_actor 0@ task 1560 status_store_to $TEMPVAR_FLOAT_3 // ret 7 if not found
                            if or  
                                84A3:   $TEMPVAR_FLOAT_2 == 7 // == constant 
                                84A3:   $TEMPVAR_FLOAT_3 == 7 // == constant 
                            then
                                gosub @character_reset_all_animation
                            end                            
                            if  001D:   tick_time > AI_next_shoot_wait  // (int)
                            then
                                0085: AI_next_shoot_wait = tick_time
                                AI_next_shoot_wait += 60 
                                function_character_current_task_id = ai_task_firing 
                                0AD2: $TEMPVAR_FLOAT_3 = player $PLAYER_CHAR targeted_actor //IF and SET

                                if or 
                                    Actor.Animation(0@) == "handsup"
                                    003B:   $TEMPVAR_FLOAT_3 == 0@  // (int)
                                    003B:   ai_target == $PLAYER_ACTOR  // (int)
                                then
                                    060B: set_actor 0@ decision_maker_to 32
                                else
                                    060B: set_actor 0@ decision_maker_to 1
                                end    
                                
                                if ai_group_type == -15
                                then
                                    07DD: set_actor 0@ attack_rate 65
                                end
                                gosub @characrer_remove_moving_animation
                                gosub @function_character_attaack_target_with_weapon
                            end
                        end
                        goto @TAMAI_Update 
                    else
                        goto @function_character_lost_visual_with_target
                    end
                else
                
                    :function_character_lost_visual_with_target
                    if  not function_character_current_task_id == ai_task_go_to_target
                    then
                        gosub @function_character_lost_the_target  
                    else
                        gosub @function_character_go_to_target_last_postion
                    end
                end
            else  //=====================================if ai not in driving

                 if ai_type == ai_type_killer
                 then
                     if gosub @function_character_go_to_target_last_postion_in_water
                     jf @TAMAI_Update
                     function_character_current_task_id = ai_task_go_to_target
                     if  gosub @function_character_go_to_target_last_postion_in_car
                     jf @TAMAI_Update
                 end
                             
            
            end
        end
    ELSE         
        01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
        
        if 001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)
        then
            if  8104: not  actor 0@ near_actor ai_target radius 10.0 10.0 2.0 sphere 0


            then
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_target with_offset 0.0 0.0 0.0
                function_character_current_task_id = ai_task_go_to_target 
                gosub @function_character_go_to_postion_with_AI
                jump @TAMAI_Update   
                 
            else
          
                07A5: AS_actor 0@ attack_actor ai_target time 6000

                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 3500
                function_character_current_task_id = ai_task_firing
                07DD: set_actor 0@ attack_rate 1000
                jump @TAMAI_Update            
            
            end   
        end    
        
    end
else
    if and
        not function_character_current_task_id == ai_playing_task_pack
        not function_character_current_task_id == ai_task_aiming
        not function_character_current_task_id == ai_idle_1
        not function_character_current_task_id == ai_idle_2
        not function_character_current_task_id == ai_idle_3
    then
        function_character_current_task_id = 0
    end
end
jump @TAMAI_Update


























































































:check_character_sub_objects
return
if  03CA:   object ai_object exists
then
    0750: set_object ai_object visibility 0

else
    ai_object = Object.Create(1318, 0, 0, 0)
    object.KeepInMemory(ai_object, true)
    object.CollisionDetection(ai_object, false)
end
return

:script_get_this_moving_tick_time
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
0085: $TEMPVAR_FLOAT_2 =  ai_move_time
$TEMPVAR_FLOAT_2 += 250 
return

:script_get_this_postion_water_high
actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
092E: get_water_height_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 ignore_waves 0 store_to ai_data4
ai_data4 += ai_swimming_water_height
return

:Tank_battle
00AA: STORE AI_DATA1 position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 
000F: $TEMPVAR_FLOAT_1 -= 7.0
000F: $TEMPVAR_FLOAT_2 -= 7.0
000F: $TEMPVAR_FLOAT_3 -= 7.0
00AA: store_car AI_DATA1 position_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD 
000F: $TEMPVAR_X_COORD -= -7.0
000F: $TEMPVAR_Y_COORD -= -7.0
000F: $TEMPVAR_Z_COORD -= -7.0
IF 8119:   NOT   car AI_DATA1 wrecked
THEN  
    IF AND
        8356:   NOT   explosion_type 3 in_cube_cornerA $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3  cornerB  $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD 
        0356:   explosion_type -1 in_cube_cornerA $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 cornerB $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD
    THEN  
        $TEMPVAR_FLOAT_1 = Car.Health(AI_DATA1)
        $TEMPVAR_FLOAT_1 -= 1
        if  $TEMPVAR_FLOAT_1 > 0
        then 
            Car.Health(AI_DATA1) = $TEMPVAR_FLOAT_1 
        else
            020B: explode_car AI_DATA1
        end
    END
END
return


 :getAngleBetweenPoints
0063: 0@ -= 2@ 
0063: 1@ -= 3@ 
0604: get_Z_angle_for_point 0@ 1@ store_to 6@
0AB2: ret 1 6@ 

:getVerticalAngle
0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_Z_COORD  from_car AI_DATA1 with_offset 0.0 0.0 0.0 
00A0: store_actor AI_TARGET position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 
0063: $TEMPVAR_FLOAT_3 -= $TEMPVAR_Z_COORD   
0097: make $TEMPVAR_FLOAT_3 absolute_float // a  
050A: AI_DATA2 = distance_between_XYZ $TEMPVAR_X_COORD $TEMPVAR_X_COORD $TEMPVAR_Z_COORD and_XYZ $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3  
0073: $TEMPVAR_FLOAT_3 /= AI_DATA2 // SIN_VA  

0087: $TEMPVAR_X_COORD = $TEMPVAR_FLOAT_3 // X
0087: $TEMPVAR_y_COORD = $TEMPVAR_FLOAT_3 // X
0087: $TEMPVAR_FLOAT_1 = $TEMPVAR_FLOAT_3 // X
0087: $TEMPVAR_FLOAT_2 = $TEMPVAR_FLOAT_3 // X
0087: $TEMPVAR_FLOAT_3 = $TEMPVAR_FLOAT_3 // X
                                
006B: $TEMPVAR_y_COORD *= $TEMPVAR_FLOAT_3  // X^2
006B: $TEMPVAR_y_COORD *= $TEMPVAR_FLOAT_3  // X^3     
006B: $TEMPVAR_FLOAT_2 *= $TEMPVAR_FLOAT_3  // X^4
006B: $TEMPVAR_FLOAT_2 *= $TEMPVAR_FLOAT_3  // X^5 
006B: 6@ *= $TEMPVAR_FLOAT_3  // X^6
006B: 6@ *= $TEMPVAR_FLOAT_3  // X^7
006B: 7@ *= $TEMPVAR_FLOAT_3  // X^8
006B: 7@ *= $TEMPVAR_FLOAT_3  // X^9 
                                
0017: 9@ /= 6.0  // X^3/6 
                                
0013: 5@ *= 3.0  
0017: 5@ /= 40.0  // 3X^5/40
                                
0013: 6@ *= 5.0  
0017: 6@ /= 112.0  // 5X^7/112
                        
0013: 7@ *= 35.0  
0017: 7@ /= 1152.0  // 35X^9/1152
                                
005B: 8@ += 9@  
0087: 12@ = 8@
005B: 8@ += 5@
                                
005B: 8@ += 12@     
0017: 8@ /= 2.0  // ARC SIN(SIN_VA)= VA
return
                        00AA: store_car AI_DATA1 position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 
                        00A0: store_actor $PLAYER_ACTOR position_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD 
                        0AB1: call_scm_func @getAngleBetweenPoints 4 from_XY $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 and_XY $TEMPVAR_X_COORD $TEMPVAR_Y_COORD store_to $TEMPVAR_Z_COORD
                        0174: $TEMPVAR_FLOAT_1 = car AI_DATA1 angle 
                        0063: $TEMPVAR_Z_COORD -= $TEMPVAR_FLOAT_1   
                        02F6: $TEMPVAR_FLOAT_2 = sine $TEMPVAR_Z_COORD 
                        02F7: $TEMPVAR_FLOAT_3 = cosine $TEMPVAR_Z_COORD 
                        0013: $TEMPVAR_FLOAT_2 *= 7.0
                        0013: $TEMPVAR_FLOAT_3 *= 7.0 
                        gosub @getVerticalAngle
                        00AA: store_car AI_DATA1 position_to $TEMPVAR_X_COORD $TEMPVAR_X_COORD $TEMPVAR_Z_COORD 
                        00A0: store_actor $PLAYER_ACTOR position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 
                        if  0025:   $TEMPVAR_FLOAT_3 > 10@  
                        then
                            0013: 8@ *= 1.0  
                            0087: 17@ = 8@  
                        else
                            0013: 8@ *= 1.0  
                            0087: 17@ = 8@ 
                        end  
                        0407: store_coords_to 8@ 9@ 10@ from_car AI_DATA1 with_offset 15@ 16@ 1.5  
                        
                        

                :function_character_drive_tank
                if
                    Actor.Driving(0@)
                then
                    
                    AI_DATA1 = Actor.CurrentCar(0@)
                    if or
                        Car.Model(AI_DATA1) == #RHINO
                        Car.Model(AI_DATA1) == #HYDRA
                    then
                        if  Car.Model(AI_DATA1) == #RHINO
                        then
                            Actor.StorePos(AI_TARGET, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
                            Car.StorePos(AI_DATA1, $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_FLOAT_3) 
                            0063: $TEMPVAR_FLOAT_1 -= $TEMPVAR_X_COORD // (float) 
                            0063: $TEMPVAR_FLOAT_2 -= $TEMPVAR_Y_COORD // (float) 
                            0604: get_Z_angle_for_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 store_to $TEMPVAR_z_COORD         
                            
                            $TEMPVAR_FLOAT_1 = Car.Angle(AI_DATA1)
                            0086: AI_DATA3 = $TEMPVAR_z_COORD
                            0063: $TEMPVAR_z_COORD -= $TEMPVAR_FLOAT_1 // (float) 
                            $TEMPVAR_z_COORD /= 57.29578 
                            AI_DATA3 /= 57.29578 
                            0A97: $TEMPVAR_FLOAT_2 = car AI_DATA1 struct 
                            $TEMPVAR_FLOAT_2 += 2380 
                            0A8C: write_memory $TEMPVAR_FLOAT_2 size 4 value $TEMPVAR_z_COORD virtual_protect 0
                             gosub @Tank_battle
                         end
                          
                         
                                         
                         
                            if 
                                 //0025:   $TEMPVAR_FLOAT_1 > AI_DATA3  // (float)
                                 //0025:   AI_DATA3 > $TEMPVAR_FLOAT_2  // (float)

                                 001D:   tick_time > AI_next_shoot_wait  // (int)
                            then
                                if  gosub @check_target_can_character_shoot
                                then
                                    0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                                    0208: $TEMPVAR_X_COORD = random_float_in_ranges -4.5 4.5
                                    0208: $TEMPVAR_Y_COORD = random_float_in_ranges -4.5 4.5
                                    $TEMPVAR_X_COORD *= 1.6
                                    005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                                    005B: $TEMPVAR_FLOAT_2 += $TEMPVAR_Y_COORD  // (float)
                                    for AI_DATA6 = 0 to 150 // step 1
                                        0AE1: $TEMPVAR_Z_COORD = random_actor_near_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 in_radius 15.0 find_next 1 pass_deads 1
                                        IF  NOT $TEMPVAR_Z_COORD == -1
                                        then
                                            //0AD1: show_formatted_text_highpriority "This is %d" time 2000 AI_DATA6

                                            089F: get_actor $TEMPVAR_Z_COORD pedtype_to $TEMPVAR_X_COORD
                                            089F: get_actor 0@ pedtype_to $TEMPVAR_Y_COORD
                                            if //and
                                                //not Actor.DrivingVehicleType($TEMPVAR_Z_COORD, #RHINO)
                                                003B:   $TEMPVAR_X_COORD == $TEMPVAR_Y_COORD  // (int)
                                            then
                                                AI_DATA1 = Actor.CurrentCar(0@)
                                                if  Car.Model(AI_DATA1) == #RHINO
                                                then
                                                    if  0104:   actor 0@ near_actor ai_target radius 60.0 60.0 60.0 sphere 0 
                                                    then
                                                    
                                                        0085: AI_next_shoot_wait = tick_time
                                                        AI_next_shoot_wait += 200 
                                                        function_character_current_task_id = ai_task_firing 
                                                        AI_DATA1 = Actor.CurrentCar(0@)
                                                        0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                                                        0208: $TEMPVAR_X_COORD = random_float_in_ranges -0.7 0.7
                                                        005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                                                        cAR.StorePos(AI_DATA1, $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD)
                                                        $TEMPVAR_Z_COORD += 2.5
                                                        06BC: create_M4_shoot_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD target $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 energy 40 
                                                        058A: create_gun_flash_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                                                        //09F1: play_audio_at_actor $PLAYER_ACTOR event 1157
                                                        $TEMPVAR_Z_COORD = -1
                                                        
                                                    end 
                                                    break     
                                                 end                
                                            end
                                        end 
                                    end // for
                                    if not $TEMPVAR_Z_COORD == -1
                                    then
                 
                                        AI_DATA1 = Actor.CurrentCar(0@)
                                        07D5: set_car AI_DATA1 velocity_in_direction_XYZ 0.1 0.0 0.1 rotation_velocitiesXY 0.0 0.0 unk 0.0

                                        
                                        //020C: create_explosion_with_radius 2 at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 
                                        0085: AI_next_shoot_wait = tick_time
                                        AI_next_shoot_wait += 6000 
                                        function_character_current_task_id = ai_task_firing 
                                    
                                    end
                    
                        
                                end
                            end                
                
            
            
                    end
                
                
                end
                goto @bool_return_true


                              
:function_character_lost_the_target
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
if and
    actor.Dead(ai_master_ped)  
    not Actor.Driving(0@)
    001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)
then
    if  not function_character_current_task_id == ai_task_go_to_target
    then    
        00A0: store_actor ai_target position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3     
        0667: AS_actor 0@ aim_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 1200 ms
        if  not function_character_current_task_id == ai_task_aiming
        then
            33@ = 0
            function_character_current_task_id = ai_task_aiming
        end
    end
    if  function_character_current_task_id == ai_task_aiming
    then
        if  33@ > 3000
        then
            function_character_current_task_id = ai_task_go_to_target
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor ai_target with_offset 0.0 0.0 0.0
            gosub @function_character_go_to_postion_with_AI
            if  not ai_data6 == -7
            jf @bool_return_false
        end
    end 
end              
goto @bool_return_true     

:function_character_go_to_target_last_postion
if  33@ > 0
then
    function_character_current_task_id = ai_task_go_to_target
    04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor ai_target with_offset 0.0 0.0 0.0
    gosub @function_character_go_to_postion_with_AI
    if  not ai_data6 == -7
    jf @bool_return_false
end       
goto @bool_return_true     



                              

:function_character_go_to_target_last_postion_in_water
actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
092E: get_water_height_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 ignore_waves 0 store_to ai_data4
ai_data4 += ai_swimming_water_height
if 
    0025:   ai_data4 > $TEMPVAR_FLOAT_3  // (float)
then
    function_character_current_task_id = ai_task_go_to_target
    04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor ai_target with_offset 0.0 0.0 0.0
    gosub @function_character_go_to_postion_with_AI
    if  not ai_data6 == -7
    jf @bool_return_false   
    goto @bool_return_false     
end
goto @bool_return_true    
        
        
        

:function_character_go_to_target_last_postion_in_car
if and
    actor.Dead(ai_master_ped)  
    Actor.Driving(0@)
then
    01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
    if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)
    then
        if  8104:  not actor 0@ near_actor ai_target radius 15.0 15.0 15.0 sphere 0 
        then
            $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@)        
            046C: $TEMPVAR_FLOAT_2 = car $TEMPVAR_FLOAT_1 driver
            if  003B:   $TEMPVAR_FLOAT_2 == 0@  // (int)
            then
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor ai_target with_offset 0.0 0.0 0.0
                gosub @function_character_go_to_postion_with_AI
                if  not ai_data6 == -7
                jf @bool_return_false 
            end
        else
            if or
                Actor.DrivingPlane(0@) 
                Actor.DrivingVehicleType(0@, #RHINO) 
            then
                goto @bool_return_true
            
            end
            if  not Actor.Driving(ai_target)
            then
                gosub @character_reset_all_animation
                0633: AS_actor 0@ exit_car
                function_character_current_task_id = ai_task_firing
                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 2000
                goto @bool_return_false 
            else
                if  84A9:  not actor 0@ driving_heli 
                then
                    gosub @character_reset_all_animation
                    $TEMPVAR_FLOAT_3 = Actor.CurrentCar(ai_target)        
                    $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@)
                    046C: $TEMPVAR_FLOAT_2 = car $TEMPVAR_FLOAT_1 driver
                    if  003B:   $TEMPVAR_FLOAT_2 == 0@  // (int)
                    then
                        06E1: AS_actor 0@ using_car -1 target_car $TEMPVAR_FLOAT_3 with_order 15 max_speed 40.0 traffic_flag 2 
                        01BD: ai_move_time = current_time_in_ms
                        ai_move_time += 2000
                        goto @bool_return_false 
                    end
                end
            end
        end
    end 
else
    function_character_current_task_id = 0
end
goto @bool_return_true














:function_character_find_car_to_kill_target
089F: get_actor 0@ pedtype_to $TEMPVAR_X_COORD

if and
    not $TEMPVAR_X_COORD == 27
    80FE:  not actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 20.0 20.0 20.0
then
    Actor.StorePos(0@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
    0AE2: ai_data5 = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 20.0 find_next 1 pass_wrecked 1
    if  not Car.Wrecked(ai_data5)
    then
        09B3: get_car ai_data5 door_status $tempvar_Float_2
        if and
          not $tempvar_Float_2 == 1
          not $tempvar_Float_2 == 2
          not $tempvar_Float_2 == 4
          
        then  
            if or
                Car.Model(ai_data5) == #RHINO
                Car.Model(ai_data5) == #HUNTER
                Car.Model(ai_data5) == #POLMAV
                Car.Model(ai_data5) == #HYDRA
            then
                046C: $tempvar_Float_1 = car ai_data5 driver
                if  Actor.Dead($tempvar_Float_1)
                then
    
                    Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                    $tempvar_Float_3 += 4.0
                    if  gosub @ai_can_be_shoot_at_pointfloat
                    then
                        07A1: set_walk_speed 6
                        05CB: AS_actor 0@ enter_car ai_data5 as_driver -1 ms
                        33@ = 0
                        01BD: ai_move_time = current_time_in_ms
                        ai_move_time += 1700
                        goto @bool_return_false
                    end
                else
                    046C: $tempvar_Float_1 = car ai_data5 driver
                    089F: get_actor $tempvar_Float_1 pedtype_to $tempvar_Float_2
                    089F: get_actor 0@ pedtype_to $tempvar_Float_3
                    if 003B:   $tempvar_Float_2 == $tempvar_Float_3 // (int)  
                    then
                        01E9: $tempvar_Float_2 = car ai_data5 num_passengers 
                        01EA: $tempvar_Float_3 = car ai_data5 max_passengers 
                        if 803B:   $tempvar_Float_2 == $tempvar_Float_3 // (int) 
                        then
                            Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                            $tempvar_Float_3 += 4.0
                            if  gosub @ai_can_be_shoot_at_pointfloat
                            then
                                07A1: set_walk_speed 6
                                //05CA: AS_actor 0@ enter_car ai_data5 passenger_seat -1 time 2000
                                0430: put_actor 0@ into_car ai_data5 passenger_seat -1
    
                                33@ = 0        
                                01BD: ai_move_time = current_time_in_ms
                                ai_move_time += 1700
                                goto @bool_return_false
                            end 
                        end                       
                    end
                end
            end
        end  

    end
end
goto @bool_return_true
         









01B9: set_actor 0@ armed_weapon_to 22
01B9: set_actor 0@ armed_weapon_to 23
01B9: set_actor 0@ armed_weapon_to 24
01B9: set_actor 0@ armed_weapon_to 25
01B9: set_actor 0@ armed_weapon_to 26
01B9: set_actor 0@ armed_weapon_to 27
01B9: set_actor 0@ armed_weapon_to 28
01B9: set_actor 0@ armed_weapon_to 29
01B9: set_actor 0@ armed_weapon_to 30
01B9: set_actor 0@ armed_weapon_to 31
01B9: set_actor 0@ armed_weapon_to 32
01B9: set_actor 0@ armed_weapon_to 33
01B9: set_actor 0@ armed_weapon_to 34
01B9: set_actor 0@ armed_weapon_to 35
01B9: set_actor 0@ armed_weapon_to 36
01B9: set_actor 0@ armed_weapon_to 37
01B9: set_actor 0@ armed_weapon_to 38
:ai_change_to_nice_weapon


return


:characrer_remove_moving_animation
if or
   Actor.Animation(0@) == "GunMove_L"
   Actor.Animation(0@) == "GunMove_R"
   Actor.Animation(0@) == "GunMove_FWD"
   Actor.Animation(0@) == "GunMove_BWD"
then
    gosub @character_reset_all_animation
end
goto @bool_return_true

:function_character_fire_weapon_in_car
if  Actor.Driving(0@)
then
    if or
         Actor.DrivingVehicleType(0@, #HYDRA)
        04A9:   actor 0@ driving_heli
    then
        if  001D:   tick_time > AI_next_shoot_wait  // (int)
        then

            if  actor.Driving(0@)  
            then
                ai_data2 = Actor.CurrentCar(0@)
                if  not Car.Wrecked(ai_data2)
                then
                    if  gosub @check_target_can_character_shoot
                    then
                        0085: AI_next_shoot_wait = tick_time
                        AI_next_shoot_wait += 160 
                        ai_data2 = Actor.CurrentCar(0@)
                        
                        if
                            Actor.DrivingVehicleType(0@, #HYDRA)
                        then
                        
                            0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            0208: $TEMPVAR_X_COORD = random_float_in_ranges -2.7 2.7
                            005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 1.0 -2.4
                            06BC: create_M4_shoot_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD target $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 energy 100 
                            058A: create_gun_flash_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            
                            0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            0208: $TEMPVAR_X_COORD = random_float_in_ranges -2.7 2.7
                            005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 1.0 -2.4
                            06BC: create_M4_shoot_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD target $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 energy 100 
                            058A: create_gun_flash_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                  
                            09F1: play_audio_at_actor 0@ event 1157
                             goto @bool_return_true
                        end
                        
                        046C: $TEMPVAR_FLOAT_1 = car ai_data2 driver
                        0432: $TEMPVAR_FLOAT_2 = get_actor_handle_from_car ai_data2 passenger_seat 1
                        if or
                            003B:   $TEMPVAR_FLOAT_1 == 0@  // (int)
                            003B:   $TEMPVAR_FLOAT_2 == 0@  // (int)
                        then
                            0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            0208: $TEMPVAR_X_COORD = random_float_in_ranges -0.7 0.7
                            005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset -1.2 0.0 -0.8
                            06BC: create_M4_shoot_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD target $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 energy 20 
                            058A: create_gun_flash_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            09F1: play_audio_at_actor 0@ event 1157
                   
                        else
                            0889: store_actor ai_target center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            0208: $TEMPVAR_X_COORD = random_float_in_ranges -0.7 0.7
                            005B: $TEMPVAR_FLOAT_1 += $TEMPVAR_X_COORD  // (float)
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 1.2 0.0 -0.8
                            06BC: create_M4_shoot_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD target $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 energy 20 
                            058A: create_gun_flash_from $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
                            09F1: play_audio_at_actor 0@ event 1157
                        end
                    end
                    goto @bool_return_true
                end   
            end
        end
    else
        if  001D:   tick_time > AI_next_shoot_wait  // (int)
        then
    

            $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@)
            046C: $TEMPVAR_FLOAT_2 = car $TEMPVAR_FLOAT_1 driver
            if  803B:  not $TEMPVAR_FLOAT_2 == 0@  // (int)
            then
                if and
                   not Actor.Animation(0@) == "Gang_DrivebyLHS"
                   not Actor.Animation(0@) == "Gang_DrivebyLHS_Bwd"
                   not Actor.Animation(0@) == "Gang_DrivebyLHS_Fwd"
                   not Actor.Animation(0@) == "Gang_DrivebyRHS"
                   not Actor.Animation(0@) == "Gang_DrivebyRHS_Bwd"
                   not Actor.Animation(0@) == "Gang_DrivebyRHS_Fwd"
                   not Actor.Animation(0@) == "Gang_DrivebyTop_LHS"
                   not Actor.Animation(0@) == "Gang_DrivebyTop_RHS"
                then
                    060B: set_actor 0@ decision_maker_to 1

                    0713: actor 0@ driveby_actor ai_target car -1 point 0 0 0 radius 900.0 4 1 firing_rate 80
                    0085: AI_next_shoot_wait = tick_time
                    AI_next_shoot_wait += 2000                  
                    goto @bool_return_false
                end
            end
        end
    end
end
goto @bool_return_true





:function_character_avoid_dangerous_goods
if  function_character_current_task_id == ai_running_away
then
    01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
    if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)
    then
        gosub @character_reset_all_animation
        function_character_current_task_id = 0
    end
    goto @bool_return_false
end

if  not Actor.Driving(0@)
then
    if  not function_character_current_task_id == ai_running_away
    then
        Actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
        for ai_data4 = 0 to 12 // step 1
            0AE2: ai_data5 = random_vehicle_near_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 in_radius 10.0 find_next 1 pass_wrecked 1
            if  not car.Wrecked(ai_data5)
            then
                if 8185: not  car ai_data5 health >= 250
                then
                    gosub @character_reset_all_animation
                    Car.StorePos(ai_data5, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
                    05DA: AS_actor 0@ run_away_in_panic_from $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3  away_radius 100.0 timelimit 30000
                    01BD: ai_move_time = current_time_in_ms
                    ai_move_time += 800
                    function_character_current_task_id = ai_running_away
                    
                    goto @bool_return_false
                end
            end
            0AE3: ai_data5 = random_object_near_point $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 in_radius 10.0 find_next 1 //IF and SET
            if  03CA:   object ai_data5 exists
            then
                if or
                    Object.Model(ai_data5) == #GRENADE
                    Object.Model(ai_data5) == #MOLOTOV
                then
                    gosub @character_reset_all_animation
                    Object.StorePos(ai_data5, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
                    05DA: AS_actor 0@ run_away_in_panic_from $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3  away_radius 100.0 timelimit 30000
                    01BD: ai_move_time = current_time_in_ms
                    ai_move_time += 800
                    function_character_current_task_id = ai_running_away
                    goto @bool_return_false
                end
            end
        end // for
    end
end

goto @bool_return_true



:function_character_attack_players_target    
if  003B:   $PLAYER_ACTOR == ai_master_ped  // (int)
jf @bool_return_true 
if or
    0AB0:   key_pressed 1   
    00E1:   player 0 pressed_key 4
then
    if 0AD2: $tempvar_Float_1 = player $PLAYER_CHAR targeted_actor //IF and SET
    then
        if not Actor.Dead($tempvar_Float_1)
        then
            089F: get_actor $tempvar_Float_1 pedtype_to $TEMPVAR_X_COORD
            089F: get_actor 0@ pedtype_to $TEMPVAR_Y_COORD
            if  803B:   $TEMPVAR_X_COORD == $TEMPVAR_Y_COORD  // (int)
            then
                function_character_current_task_id = ai_task_firing
                0085: ai_target = $tempvar_Float_1 
                next_get_target_wait = -200
            end
        end
    end
end     
goto @bool_return_true





:function_character_follow_the_master

            
            
if  056D:   actor ai_master_ped defined
then    
    if  not Actor.Dead(ai_master_ped)
    then
 
        01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
        if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)
        then
            if  special_command == 59
            then
                gosub @AI_GoPlayerTargetPoint
                goto @bool_return_true
            end      
            if or
                function_character_current_task_id == ai_entering_leader_car 
                not function_character_current_task_id == ai_in_leader_car
            then
                if  gosub @ai_is_leader_driving_car_and_have_enough_oassengers
                then
                    gosub @ai_enter_Leader_drving_Car
                end
                if  0449:   Actor 0@ in_a_car 
                then
                    function_character_current_task_id = ai_in_leader_car
                end
            else
                
            end
            if  Actor.Driving(0@)
            then
                if  Actor.Driving(ai_master_ped)
                then
                    if  80F2:   actor 0@ near_actor ai_master_ped radius 10.0 10.0 0 
                    then
                        if  80F2:   actor 0@ near_actor ai_master_ped radius 20.0 20.0 0 
                        then
                            0208: $tempvar_Float_1 = random_float_in_ranges -1.0 1.0
                            0208: $tempvar_Float_2 = random_float_in_ranges -1.0 1.0
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $tempvar_Float_1 $tempvar_Float_2 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if not ai_data6 == -7
                            jf @bool_return_false 
                        else
                            $tempvar_Float_2 = actor.CurrentCar(ai_master_ped)
                            06E1: AS_actor 0@ using_car -1 target_car $tempvar_Float_2 with_order 32 max_speed 40.0 traffic_flag 2
                            01BD: ai_move_time = current_time_in_ms
                            ai_move_time += 1700
     
                        end
                    end
                else
                    if  80F2:   actor 0@ near_actor ai_master_ped radius 15.0 15.0 0 
                    then
                        0208: $tempvar_Float_1 = random_float_in_ranges -1.0 1.0
                        0208: $tempvar_Float_2 = random_float_in_ranges -1.0 1.0
                        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $tempvar_Float_1 $tempvar_Float_2 0.0
                        gosub @function_character_go_to_postion_with_AI
                        if not ai_data6 == -7
                        jf @bool_return_false 
                    else
                        if and
                            not Actor.DrivingVehicleType(0@, #RHINO) 
                            not Actor.DrivingPlane(0@)
                            not Actor.Driving(ai_master_ped)
                        then
                            0633: AS_actor 0@ exit_car
                            function_character_current_task_id = 0
                            01BD: ai_move_time = current_time_in_ms
                            ai_move_time += 1700
                            goto @bool_return_false
                        end
                    end
                end
            else
                if  80F2:  not is_actor 0@ near_actor ai_master_ped radius 3.0 3.0 0 
                then
                    if  00F2:   actor 0@ near_actor ai_master_ped radius 15.0 15.0 0 
                    then
                        0208: $tempvar_Float_1 = random_float_in_ranges -1.3 1.3
                        0208: $tempvar_Float_2 = random_float_in_ranges -1.3 1.3
                        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $tempvar_Float_1 $tempvar_Float_2 0.0
                        gosub @function_character_go_to_postion_with_AI   


                        if not ai_data6 == -7
                        jf @bool_return_false                   
                    else
                        0208: $tempvar_Float_1 = random_float_in_ranges -1.3 1.3
                        0208: $tempvar_Float_2 = random_float_in_ranges -1.3 1.3
                        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $tempvar_Float_1 $tempvar_Float_2 0.0
                        0085: ai_data0 = function_character_current_task_id
                        function_character_current_task_id = 0
                        gosub @function_character_go_to_postion_with_AI         
                        0085: function_character_current_task_id = ai_data0
                        if not ai_data6 == -7
                        jf @bool_return_false 
                    end
                end
                if  0A1B:   actor ai_master_ped colliding_with_actor 0@
                then
                    if or
                        function_character_current_task_id == ai_task_firing
                        function_character_current_task_id == ai_task_aiming
                    then
                        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset 0.0 2.0 0.0
                        gosub @function_character_go_to_postion_with_AI 
                        if not ai_data6 == -7
                        jf @bool_return_false 
                    end
                end
            end        
        
        end
    end
end
goto @bool_return_true

:clean_temporary_global_variable
$tempvar_Float_1 = 0.0
$tempvar_Float_2 = 0.0
$tempvar_Float_3 = 0.0
$TEMPVAR_X_COORD = 0.0
$TEMPVAR_Y_COORD = 0.0
$TEMPVAR_Z_COORD = 0.0
$TEMPVAR_ACTOR_CAR = -1
ai_data1 = -1
ai_data2 = -1
ai_data3 = -1
ai_data4 = -1
ai_data5 = -1
ai_data6 = -1
ai_get_closest_target_id = -1
ai_get_closest_target_ped =- 1
ai_get_closest_target_ped2 = -1
ai_get_closest_target_memory = 0
return


:ai_is_leader_driving_car_and_have_enough_oassengers         
if  0449:  Actor ai_master_ped in_a_car 
then
    0811: $tempvar_Float_1 = actor ai_master_ped used_car
    01E9: $tempvar_Float_2 = car $tempvar_Float_1 num_passengers 
    01EA: $tempvar_Float_3 = car $tempvar_Float_1 max_passengers 
    if 803B:   $tempvar_Float_2 == $tempvar_Float_3 // (int) 
    then
        if 8449: not  Actor 0@ in_a_car 
        then
            goto @bool_return_true
        end
    else
        if 8449: not  Actor 0@ in_a_car 
        then
            for ai_data4 = 0 to 40 // step 1
                Actor.StorePos(0@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                0AE2: ai_data5 = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 40.0 find_next 1 pass_wrecked 1
                if  not Car.Wrecked(ai_data5)
                then
                    09B3: get_car ai_data5 door_status $tempvar_Float_2
                    if and
                      not $tempvar_Float_2 == 1
                      not $tempvar_Float_2 == 2
                      not $tempvar_Float_2 == 4
                    then  
                        046C: $tempvar_Float_1 = car ai_data5 driver
                        if  Actor.Dead($tempvar_Float_1)
                        then
    
                            Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                            $tempvar_Float_3 += 4.0
                            if  gosub @ai_can_be_shoot_at_pointfloat
                            then
                                07A1: set_walk_speed 6
                                05CB: AS_actor 0@ enter_car ai_data5 as_driver -1 ms
                                function_character_current_task_id = ai_in_leader_car 
                                33@ = 0
                                01BD: ai_move_time = current_time_in_ms
                                ai_move_time += 1700
                                goto @bool_return_true
                            end
                        else
                            046C: $tempvar_Float_1 = car ai_data5 driver
                            089F: get_actor $tempvar_Float_1 pedtype_to $tempvar_Float_2
                            089F: get_actor 0@ pedtype_to $tempvar_Float_3
                            if 003B:   $tempvar_Float_2 == $tempvar_Float_3 // (int)  
                            then
                                01E9: $tempvar_Float_2 = car ai_data5 num_passengers 
                                01EA: $tempvar_Float_3 = car ai_data5 max_passengers 
                                if 803B:   $tempvar_Float_2 == $tempvar_Float_3 // (int) 
                                then
                                    Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                                    $tempvar_Float_3 += 4.0
                                    if  gosub @ai_can_be_shoot_at_pointfloat
                                    then
                                        07A1: set_walk_speed 6
                                        05CA: AS_actor 0@ enter_car ai_data5 passenger_seat -1 time 2000
                                        function_character_current_task_id = ai_in_leader_car 
                                        33@ = 0        
                                        01BD: ai_move_time = current_time_in_ms
                                        ai_move_time += 1700
                                        goto @bool_return_true
                                    end 
                                end                       
                            end
                        end
                    
                    end  

                end
            end     
        end // for
    end
end
goto @bool_return_false

:ai_enter_Leader_drving_Car
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
if and
    not function_character_current_task_id == ai_in_leader_car  
    Actor.Driving(ai_master_ped) 
    001D: $TEMPVAR_FLOAT_1 > ai_move_time
then
    gosub @character_reset_all_animation
    if or
        not function_character_current_task_id == ai_entering_leader_car 
        33@ > 3000
    then
        0811: $tempvar_Float_1 = actor ai_master_ped used_car
        if
        003B:   ai_master_ped == $Player_Actor  // (int)
        then
            if 0104:   actor ai_master_ped near_actor 0@ radius 20.0 20.0 20.0 0
            then
                05CA: AS_actor 0@ enter_car $tempvar_Float_1 passenger_seat -1 time 3000
            else    
                0430: put_actor 0@ into_car $tempvar_Float_1 passenger_seat -1
                return
            end
        else
            0430: put_actor 0@ into_car $tempvar_Float_1 passenger_seat -1
        end
        function_character_current_task_id = ai_entering_leader_car 
        33@ = 0
    end
    01BD: ai_move_time = current_time_in_ms
    ai_move_time += 2000
    
end
return


:ai_exit_Leaders_Car_when_ldear_leave
if or 
    function_character_current_task_id == ai_entering_leader_car  
    function_character_current_task_id == ai_in_leader_car 
    actor.Driving(0@) 
then
    if  8449:  not_actor ai_master_ped in_a_car 
    then
        if and
             0104:   actor 0@ near_actor ai_master_ped radius 15.0 15.0 15.0 sphere 0
             00DF:   actor 0@ driving
             not Actor.DrivingVehicleType(0@, #RHINO) 
              not Actor.DrivingPlane(0@)
        then
            0633: AS_actor 0@ exit_car 
            01BD: ai_move_time = current_time_in_ms
            ai_move_time += 1700
            function_character_current_task_id = 0
            33@ = 0
            goto @bool_return_false
        end
        if or 
            function_character_current_task_id == ai_entering_leader_car  
            function_character_current_task_id == ai_in_leader_car  
        then
            01BD: ai_move_time = current_time_in_ms
            ai_move_time += 500

            function_character_current_task_id = 0
            33@ = 0
            goto @bool_return_false    
        end
    end 
end
goto @bool_return_true



:function_character_in_player_group //?
if  803B:   $PLAYER_ACTOR == 0@    // ��� AI ������Լ����޷��Ի� 
jf @bool_return_true
if  06EE:   actor 0@ in_group $PLAYER_GROUP    //�ж� NPC �Ƿ����������Ŷ� 
then
    06C9: remove_actor 0@ from_group
    0085: ai_master_ped = $PLAYER_ACTOR
    gosub @character_reset_all_animation
    goto @bool_return_false

end 
goto @bool_return_true

:function_character_peripheral_response
if  Actor.Driving(0@)
then
    goto @bool_return_true
end
if  function_character_current_task_id == ai_task_aiming
then
    if 33@ > 5000
    then
        function_character_current_task_id = 0
    end
end
if  02E0:   actor $PLAYER_ACTOR firing_weapon  
then
    if or
        ai_group_type == group_friend
        ai_type == ai_type_friend
        003B:   ai_master_ped == $PLAYER_ACTOR    // ��� AI ������Լ����޷��Ի�     
    then
        if or 
            function_character_current_task_id == 0  
            function_character_current_task_id == ai_playing_task_pack
            function_character_current_task_id == ai_idle_1
            function_character_current_task_id == ai_idle_2
            function_character_current_task_id == ai_idle_3
        then
            if  0104:   actor $PLAYER_ACTOR near_actor 0@ radius 30.0 30.0 100.0 sphere 0
            then
                gosub @character_reset_all_animation
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor $PLAYER_ACTOR with_offset 0.0 40.0 0.0
                0667: AS_actor 0@ rotate_and_aim_at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD 5000 ms
                function_character_current_task_id = ai_task_aiming
                33@ = 0
            end
        end
    end  
    if or
        ai_group_type == group_enemy1
        ai_group_type == group_enemy2
        ai_group_type == group_enemy3
        ai_group_type == group_enemy4
        ai_group_type == group_police
        ai_group_type == group_ballas1
        ai_group_type == group_ballas2    
    then
        if or 
            function_character_current_task_id == 0  
            function_character_current_task_id == ai_playing_task_pack
        then
            if  0104:   actor $PLAYER_ACTOR near_actor 0@ radius 30.0 30.0 100.0 sphere 0
            then
                gosub @character_reset_all_animation
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0
                0667: AS_actor 0@ rotate_and_aim_at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD 5000 ms
                function_character_current_task_id = ai_task_aiming
                33@ = 0
            end
        end
    end    
end
goto @bool_return_true

:function_character_idle_animation
if not ai_type == ai_type_locked
jf @bool_return_true
if and
    not function_character_current_task_id == function_character_search_shelter_1
    not function_character_current_task_id == function_character_search_shelter_2
    not function_character_current_task_id == function_character_search_shelter_3
    not function_character_current_task_id == function_character_search_shelter_4
jf @bool_return_true

    
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
0085: $tempvar_Float_2 = ai_move_time
$tempvar_Float_2 += 600
if  001D:   $TEMPVAR_FLOAT_1 > $tempvar_Float_2  // (int)   
then
    if  special_command == 59
    then
        gosub @AI_GoPlayerTargetPoint
        goto @bool_return_true
    end   
            
            
            
    if  ai_type == ai_type_stayer
    then
        if  80FE:   not actor 0@ sphere 0 in_sphere AI_POINT_X AI_POINT_Y AI_POINT_Z radius 1.0 1.0 1000.0
        then 
            0086: $TEMPVAR_X_COORD = AI_POINT_X
            0086: $TEMPVAR_Y_COORD = AI_POINT_y
            0086: $TEMPVAR_Z_COORD = AI_POINT_Z
            gosub @function_character_go_to_postion_with_AI 
            if not ai_data6 == -7
            jf @bool_return_false    
        end
    end
    if  function_character_current_task_id == 0 
    then
        
        function_character_current_task_id = ai_idle_1
        gosub @character_reset_all_animation
        if and
            not ai_group_type == group_police 
            not ai_taskpack == -2
            not Actor.Driving(0@)
        then
            04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 20.0 0.0
            0667: AS_actor 0@ rotate_and_aim_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 -1 ms
            
            33@ = 0
            goto @bool_return_true
            
        end
        33@ = 1000000000
        goto @bool_return_true 
    end  
    
    if  function_character_current_task_id == ai_idle_1 
    then
        if  33@ > 2500
        then
            33@ = 0
            function_character_current_task_id = ai_idle_1


            if not Actor.Driving(0@)
            then
                if  not Actor.Dead(ai_master_ped)
                then
                    0A1D: AS_actor 0@ rotate_to_and_look_at_actor ai_master_ped
                    goto @bool_return_true 
                else
                    if  ai_taskpack > 16
                    then
                        0618: assign_actor 0@ to_AS_pack ai_taskpack
                        33@ = -60000
                        goto @bool_return_true 
                    end  
                    if and
                        Actor.Dead(ai_master_ped)
                        ai_group_type == group_police
                    then
                        05DE: AS_actor 0@ walk_around_ped_path
                        33@ -= 60000
                        goto @bool_return_true 
                    
                    end
                    if and  
                        Actor.Dead(ai_master_ped) 
                        ai_type == ai_type_killer
                    then
                        if and
                            not function_character_current_task_id == ai_idle_3  
                            ai_type == ai_type_killer
                        then
                            function_character_current_task_id = ai_idle_3
                            33@ = 25000
                        end   
                    else
                        05C8: AS_actor 0@ look_around
                    end
                end
            else
                if and
                    not function_character_current_task_id == ai_idle_3  
                    ai_type == ai_type_killer
                then
                    function_character_current_task_id = ai_idle_3
                    33@ = 25000
                end            
            end
        end
    end  
    if  function_character_current_task_id == ai_idle_3
    then
        if  33@ > 10000
        then    
            if  special_command == 59
            then
                gosub @AI_GoPlayerTargetPoint
                33@ = 0
            else        
                gosub @AI_GoRandomPoint 
                33@ = 0
            end
        end
        if  not Actor.Dead(ai_master_ped)
        then
            function_character_current_task_id = 0
        end
    end 
                 
end
goto @bool_return_true 





:function_character_enter_interior
if  ai_group_type == group_police
then
    if Player.WantedLevel($PLAYER_CHAR) > 0
    then
        077E: get_active_interior_to $TEMPVAR_Y_COORD
        09E8: $TEMPVAR_Z_COORD = actor 0@ active_interior
        if  803B:  not $TEMPVAR_Z_COORD == $TEMPVAR_Y_COORD  // (int)  
        then
            04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 0.0 0.0
            //08E5: get_actor_in_sphere $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 1.0 handle_as ai_data4
            wait 2020
            gosub @check_character_defined                  //must use, else crash game
            if 
                not Actor.Dead(0@)
            then
                gosub @character_reset_all_animation
                0208: $TEMPVAR_FLOAT_1 = random_float_in_ranges -1.0 1.0
                0208: $TEMPVAR_FLOAT_2 = random_float_in_ranges 0.0 1.5
                $TEMPVAR_FLOAT_1 *= 1.5
                $TEMPVAR_FLOAT_2 *= 1.5
                077E: get_active_interior_to $TEMPVAR_Z_COORD
                0860: link_actor 0@ to_interior $TEMPVAR_Z_COORD    
                04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor $PLAYER_ACTOR with_offset $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 -0.5
                


                while true
                    wait 0
                    gosub @check_character_defined 
                    if
                    80FE: not  actor $PLAYER_ACTOR sphere 0 in_sphere ai_data1 ai_data2 ai_data3 radius 8.0 8.0 8.0
                    then
                        0792: disembark_instantly_actor 0@
                        0972: put_actor 0@ at ai_data1 ai_data2 ai_data3 no_offset
                        //Actor.RemoveReferences(ai_data4)
                        goto @bool_return_true
                    end         
                end // while
                
            else
                goto @bool_return_true
            end
        end
    end
end

if  not Actor.Dead(ai_master_ped)
then
 
    if and
        not special_command == 591 
        80F2:  not actor ai_master_ped near_actor 0@ radius 160.0 160.0 sphere 0
    then
        
        0208: $TEMPVAR_FLOAT_1 = random_float_in_ranges -4.0 4.0
        0208: $TEMPVAR_FLOAT_2 = random_float_in_ranges -4.0 -4.5
        $TEMPVAR_FLOAT_1 *= 1.5
        $TEMPVAR_FLOAT_2 *= 1.5
        077E: get_active_interior_to $TEMPVAR_Z_COORD
        0860: link_actor 0@ to_interior $TEMPVAR_Z_COORD    
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 0.0
        0972: put_actor 0@ at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD no_offset  
    end
    077E: get_active_interior_to $TEMPVAR_Y_COORD
    09E8: $TEMPVAR_Z_COORD = actor 0@ active_interior
    if  803B:  not $TEMPVAR_Z_COORD == $TEMPVAR_Y_COORD  // (int)  
    then
        wait 2020
        gosub @check_character_defined                  //must use, else crash game
        if and
            not Actor.Dead(0@)
            not Actor.Dead(ai_master_ped)
        then
            gosub @character_reset_all_animation
            0208: $TEMPVAR_FLOAT_1 = random_float_in_ranges -1.0 1.0
            0208: $TEMPVAR_FLOAT_2 = random_float_in_ranges 0.0 1.5
            $TEMPVAR_FLOAT_1 *= 1.5
            $TEMPVAR_FLOAT_2 *= 1.5
            077E: get_active_interior_to $TEMPVAR_Z_COORD
            0860: link_actor 0@ to_interior $TEMPVAR_Z_COORD    
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_master_ped with_offset $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 -0.5
            0972: put_actor 0@ at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD no_offset 
        end
    end
end
goto @bool_return_true

     { 04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor ai_target with_offset 0.0 0.0 0.0 
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 0.0 0.0 
                0063: $TEMPVAR_X_COORD -= $TEMPVAR_FLOAT_1 // (float) 
                0063: $TEMPVAR_Y_COORD -= $TEMPVAR_FLOAT_2 // (float) 
                0604: get_Z_angle_for_point $TEMPVAR_X_COORD $TEMPVAR_Y_COORD store_to $TEMPVAR_FLOAT_1 
                $TEMPVAR_FLOAT_1 += 180.0 
                0656: get_angle $TEMPVAR_FLOAT_1 absolute_degrees_to $TEMPVAR_FLOAT_1
                Actor.Angle(0@) = $TEMPVAR_FLOAT_1
                if and 
                   not Actor.Animation(0@) == "FightA_1"
                   not Actor.Animation(0@) == "FightA_2"
                then           
                    gosub @character_reset_all_animation
                    0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges 0 2
                    if $TEMPVAR_FLOAT_1 == 0
                    then
                        0812: AS_actor 0@ perform_animation "FightA_1" IFP "PED" framedelta 8.0 loopA 0 lockX 1 lockY 1 lockF 0 time -1  // versionB
                    else
                        0812: AS_actor 0@ perform_animation "FightA_2" IFP "PED" framedelta 8.0 loopA 0 lockX 1 lockY 1 lockF 0 time -1  // versionB
                    end
                    if  not Actor.Driving(ai_target)
                    then
                        //0669: $TEMPVAR_FLOAT_3 = attach_particle "shootlight" to_actor ai_target with_offset 0.0 0.0 0.0 type 1 
                        //064C: make_particle $TEMPVAR_FLOAT_3 visible 
                        if  803B:   not  ai_target == $Player_Actor // (int)
                        then
                            $TEMPVAR_FLOAT_1 = Actor.Health(ai_target) 
                            $TEMPVAR_FLOAT_1 -= 25
                            if  $TEMPVAR_FLOAT_1 < 0
                            then
                                $TEMPVAR_FLOAT_1 = 0
                            end
                            0851: set_actor ai_target decrease_health_by $TEMPVAR_FLOAT_1 affect_armour 1
                        else
                            05C1: AS_actor $PLAYER_ACTOR play_auido_id 344  //In pain
                            0851: set_actor ai_target decrease_health_by 5 affect_armour 1
                        end
                    else
                        //0669: $TEMPVAR_FLOAT_3 = attach_particle "shootlight" to_actor ai_target with_offset 0.0 1.0 0.0 type 1 
                        //064C: make_particle $TEMPVAR_FLOAT_3 visible 
                        $tempvar_Actor_Car = Actor.CurrentCar(ai_target)
                        $TEMPVAR_FLOAT_1 = Car.Health($tempvar_Actor_Car) 
                        $TEMPVAR_FLOAT_1 -= 15
                        Car.Health($tempvar_Actor_Car) = $TEMPVAR_FLOAT_1                     
                    end
                end             }

:function_character_search_shelter
if  not Actor.Driving(0@)
jf @bool_return_false
if and
     not function_character_current_task_id == function_character_search_shelter_1 
     not function_character_current_task_id == function_character_search_shelter_2
     not function_character_current_task_id == function_character_search_shelter_3
     not function_character_current_task_id == function_character_search_shelter_4
     not function_character_current_task_id == ai_task_go_to_target
then
    //0209: $tempvar_Float_1 = random_int_in_ranges -32767 32767
    //0209: $tempvar_Float_2 = random_int_in_ranges -32767 32767
    //0A8D: $TEMPVAR_FLOAT_3 = read_memory 5499202 size 2 virtual_protect 0
    01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
    0085: $tempvar_Float_2 = ai_move_time
    if and
        001D:   $TEMPVAR_FLOAT_1 > $tempvar_Float_2  // (int)  
       0457:   player $PLAYER_CHAR aiming_at_actor 0@

    then   
    
    
        0209: $tempvar_Float_1 = random_int_in_ranges -32767 32767
        if 
            $tempvar_Float_1 >= 0
        then                
            $tempvar_Float_2 = 5.0
        else
            $tempvar_Float_2 = -5.0
        end
        function_character_current_task_id = ai_task_firing
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset $tempvar_Float_2 -1.0 0.0
        gosub @function_character_go_to_postion_with_AI
        if ai_data6 == -7
        then
            goto @bool_return_false
        end
    end      
end
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)   
then
    if and
         not function_character_current_task_id == function_character_search_shelter_1 
         not function_character_current_task_id == function_character_search_shelter_2
         not function_character_current_task_id == function_character_search_shelter_3
         not function_character_current_task_id == function_character_search_shelter_4
    then
        ai_data5 = -1
        for ai_data4 = 0 to 35 // step 1
            Actor.StorePos(0@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
            0AE2: ai_data3 = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 20.0 find_next 1 pass_wrecked 1 //IF and SET 
            if  056E:   car ai_data3 defined 
            then
                if  Car.Wrecked(ai_data5)
                then
                    Actor.StorePos(0@, $tempvar_X_coord, $tempvar_Y_coord, $tempvar_Z_coord)
                    Car.StorePos(ai_data3, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                    050A: ai_data2 = distance_between_XYZ $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 and_XYZ $tempvar_X_coord $tempvar_Y_coord $tempvar_Z_coord
                    0086: ai_data1 = ai_data2 
                    0085: ai_data5 = ai_data3
                else   
                    if and
                        056E:   car ai_data3 defined
                        01C1:   car ai_data3 stopped
                    then  
                        Car.StorePos(ai_data3, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                        $tempvar_Float_3 += 5.0
                        0086: $tempvar_X_coord = ai_data1
                        0086: $tempvar_Y_coord = ai_data2
                        0085: $tempvar_Z_coord = ai_data3
                        if  gosub @ai_can_be_shoot_at_pointfloat
                        then
                            0086: ai_data1 = $tempvar_X_coord
                            0086: ai_data2 = $tempvar_Y_coord 
                            0085: ai_data3 = $tempvar_Z_coord 
                            
                             Actor.StorePos(0@, $tempvar_X_coord, $tempvar_Y_coord, $tempvar_Z_coord)
                             Car.StorePos(ai_data3, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                             050A: ai_data2 = distance_between_XYZ $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 and_XYZ $tempvar_X_coord $tempvar_Y_coord $tempvar_Z_coord
                             if  0025:   ai_data1 > ai_data2  // (float)
                             then
                                 0086: ai_data1 = ai_data2 
                                 0085: ai_data5 = ai_data3    
                             end 
                        else
                            0086: ai_data1 = $tempvar_X_coord
                            0086: ai_data2 = $tempvar_Y_coord 
                            0085: ai_data3 = $tempvar_Z_coord 
                        end
                    end       
                end
            end
        end
        

        if  056E:   car ai_data5 defined
        then
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 1.3 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else       
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 1.3 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        
                        goto @bool_return_false
                    end
                end
            end
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 1.3 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else            
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 1.3 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        goto @bool_return_false
                    end
                end
            end
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 -1.4 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else            
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 -1.4 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then                
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        goto @bool_return_false
                    end
                end
            end
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 -1.4 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else            
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 -1.4 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        goto @bool_return_false
                    end
                end
            end
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 0.0 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else            
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 0.0 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        goto @bool_return_false
                    end
                end
            end
            0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 0.0 0.0
            if  gosub @ai_target_can_go_to_pointfloat
            then
            else            
                0086: ai_data1 = $tempvar_Float_1
                0086: ai_data2 = $tempvar_Float_2
                0086: ai_data3 = $tempvar_Float_3
                $tempvar_Float_1 -= 0.5
                $tempvar_Float_2 += 0.5
                $tempvar_Float_3 -= 0.3
                ai_data1 += 0.5
                ai_data2 -= 0.5
                ai_data3 += 0.5
                if  06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                then
                    0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 0.0 0.0
                    gosub @function_character_go_to_postion_with_AI
                    if  ai_data6 == -7
                    then                    
                        0085: ai_cover_object = ai_data5
                        function_character_current_task_id = function_character_search_shelter_2
                        goto @bool_return_false
                    end
                end
            end   
        end
    end
end
goto @bool_return_true

:function_character_search_shelter3
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)   
then

    if or
    function_character_current_task_id == function_character_search_shelter_3 
    function_character_current_task_id == function_character_search_shelter_4
    then
        
                
        0085: ai_data5 = ai_cover_object
        gosub @function_character_search_shelter2_1
        if  056E:   car ai_data5 defined
        then
            if 0202:   actor 0@ near_car ai_data5 radius 10.0 10.0 sphere 0
            then
            
            else
                function_character_current_task_id = ai_task_firing
                goto @bool_return_true
            end
        else
            function_character_current_task_id = ai_task_firing
            goto @bool_return_true
        end
        Actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3  )
        $TEMPVAR_FLOAT_3 -= 0.4
        if  gosub @ai_target_can_go_to_pointfloat
        then
            function_character_current_task_id = ai_task_firing
            goto @bool_return_true
        end
        if and
            function_character_current_task_id == function_character_search_shelter_3 
            33@ > 2500
        then
            gosub @character_reset_all_animation
            0638: AS_actor 0@ stay_put 1

            04EB: AS_actor 0@ crouch 1    
            function_character_current_task_id = function_character_search_shelter_4 
            33@ = 0
            01BD: ai_move_time = current_time_in_ms
            ai_move_time += 300
            //0ACE: show_formatted_text_box "1 %d" 33@
        end
        if and
            function_character_current_task_id == function_character_search_shelter_4 
            33@ > 2000
            8457:  not player $PLAYER_CHAR aiming_at_actor 0@
        then
            gosub @character_reset_all_animation
            04EB: AS_actor 0@ crouch 0
            function_character_current_task_id = function_character_search_shelter_3
            33@ = 0
            01BD: ai_move_time = current_time_in_ms
            ai_move_time += 300

        end   
        if  function_character_current_task_id == function_character_search_shelter_3
        then
            if 33@ > 250
            then
                gosub @function_character_attaack_target_with_weapon  
            end
            if 33@ > 1000
            then
                if  0457:   player $PLAYER_CHAR aiming_at_actor 0@
                then
                    gosub @character_reset_all_animation
                    0638: AS_actor 0@ stay_put 1
                    04EB: AS_actor 0@ crouch 1
                    function_character_current_task_id = function_character_search_shelter_4 
                    33@ = 0
                end
            end
            goto @bool_return_false
        end     
    end
end

goto @bool_return_true




:function_character_search_shelter2
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
if  001D:   $TEMPVAR_FLOAT_1 > ai_move_time  // (int)   
then
    if 
         function_character_current_task_id == function_character_search_shelter_2
    then
        0085: ai_data5 = ai_cover_object
        
        :function_character_search_shelter2_1
        if  
            056E:   car ai_data5 defined
        then
            if   0202:   actor 0@ near_car ai_data5 radius 20.0 20.0 sphere 0
            then  
                Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                $tempvar_Float_3 += 4.0
                
                
                if  gosub @ai_can_be_shoot_at_pointfloat
                then
                    
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 1.3 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else            
                        

                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5   
                            then
                                if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                        
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 1.3 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 1.3 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else            
                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            then
                               if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                        
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 1.3 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 -1.4 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else            
                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            then
                               if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                         
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 -1.4 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 -1.4 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else            
                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5   
                            then
                               if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                      
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 -1.4 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset 1.8 0.0 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else        
                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            then
                               if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                        
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset 1.8 0.0 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                0085: ai_cover_object = ai_data5
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                    0407: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_car ai_data5 with_offset -1.8 0.0 0.0
                    if  gosub @ai_target_can_go_to_pointfloat
                    then
                    else            
                        0086: ai_data1 = $tempvar_Float_1
                        0086: ai_data2 = $tempvar_Float_2
                        0086: ai_data3 = $tempvar_Float_3
                        0086: $TEMPVAR_X_COORD = $tempvar_Float_1
                        0086: $TEMPVAR_Y_COORD = $tempvar_Float_2
                        0086: $TEMPVAR_Z_COORD = $tempvar_Float_3
                        $tempvar_Float_1 -= 0.6
                        $tempvar_Float_2 += 0.6
                        $tempvar_Float_3 -= 0.3
                        ai_data1 += 0.6
                        ai_data2 -= 0.6
                        ai_data3 += 0.6
                        if or
                            00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5 
                            06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 solid 0 car 0 actor 1 object 0 particle 0
                        then
                            if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD radius 1.3 1.3 1.5  
                            then
                               if  not function_character_current_task_id == function_character_search_shelter_4
                                then
                                    function_character_current_task_id = function_character_search_shelter_3
                                end
                                goto @bool_return_true                        
                            end
                            0407: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_car ai_data5 with_offset -1.8 0.0 0.0
                            gosub @function_character_go_to_postion_with_AI
                            if  ai_data6 == -7
                            then
                                function_character_current_task_id = function_character_search_shelter_2
                                goto @bool_return_false
                            end
                        end
                    end
                end
            else
                function_character_current_task_id = ai_task_firing
            end 
        else
            function_character_current_task_id = ai_task_firing    
        end 
    end
end
goto @bool_return_true









:function_character_climb_obstacle
if
    not Actor.Driving(0@)
then
    if
    00A4:   actor 0@ sphere 0 in_cube_cornerA -2243.0771 2342.3389 3.9918 cornerB -2211.9951 2311.144 5.9918
    then

        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.1 4.5 0.1
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.1 0.0 -0.2
        if 
          86BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 0 particle 0
        then   
            0792: disembark_instantly_actor 0@
            for $TEMPVAR_FLOAT_1 = 0 to 4 // step 1
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 -0.115 -1.0     
                Actor.PutAt(0@, $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD)     
            end
            078F: AS_actor 0@ climb 1
            083C: set_actor 0@ velocity_in_direction_XYZ 0.0 0.0 6.0
            if  function_character_current_task_id == ai_idle_3
            then
                33@ = 26000
            else
                function_character_current_task_id = 0
            end
            wait 600
            goto @bool_return_false   

        end 
    
    end
    
    if
        Actor.Animation(0@) == "HIT_wall"
    then
        if  80FE:  not actor 0@ sphere 0 in_sphere 2149.3589 -2262.217 13.3017 radius 55.0 55.0 55.0
        then
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 1.0 0.0
            04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 0.0 0.0
            if 
              86BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 1 particle 0
            then
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 1.0 6.0
                04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.5 3.0
                if 
                  06BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 1 particle 0
                then
                    04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset -0.3 0.8 3.0
                    04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.3 -0.5 0.0
                    if 
                      06BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 1 particle 0
                    then                         
                        gosub @character_reset_all_animation
                        for $TEMPVAR_FLOAT_1 = 0 to 4 // step 1
                            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset 0.0 -0.1 -1.0     
                            Actor.PutAt(0@, $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD)     
                        end
                        078F: AS_actor 0@ climb 1
                        083C: set_actor 0@ velocity_in_direction_XYZ 0.0 0.0 6.0
                        if  function_character_current_task_id == ai_idle_3
                        then
                            33@ = 26000
                        else
                            function_character_current_task_id = 0
                        end
                        wait 600
                        goto @bool_return_false
                    end
                end
            end
        end
    end
end
goto @bool_return_true



:function_character_set_animation_rate
0393: actor 0@ perform_animation "GunMove_L" at speed_ai_move_with_shooting times_normal_rate 
0393: actor 0@ perform_animation "GunMove_R" at speed_ai_move_with_shooting times_normal_rate 
0393: actor 0@ perform_animation "GunMove_BWD" at speed_ai_move_with_shooting times_normal_rate 
0393: actor 0@ perform_animation "GunMove_FWD" at speed_ai_move_with_shooting times_normal_rate 
0393: actor 0@ perform_animation "Swim_Breast" at speed_ai_move_with_shooting times_normal_rate 
0393: actor 0@ perform_animation "SWIM_crawl" at speed_ai_move_with_shooting times_normal_rate   
next_get_target_wait += 1
return


:listener_detector_can_character_kill_fail
0085:  ai_target = ai_data0
goto @listener_detector_foreach_next

:listener_detector_can_character_kill  
if  803C:   not  $PLAYER_ACTOR == ai_get_closest_target_ped //
jf @listener_detector_can_character_kill_if_is_player
if  not Actor.Dead(ai_get_closest_target_ped)
jf @listener_detector_foreach_next
089F: get_actor ai_get_closest_target_ped pedtype_to $TEMPVAR_FLOAT_1
089F: get_actor 0@ pedtype_to $TEMPVAR_FLOAT_2
if or
        $TEMPVAR_FLOAT_1 == 3
        $TEMPVAR_FLOAT_1 == 4    
        $TEMPVAR_FLOAT_1 == 5
803B:   $TEMPVAR_FLOAT_1 == $TEMPVAR_FLOAT_2  // (int)
jf @listener_detector_foreach_next
0085: ai_data4 = $TEMPVAR_FLOAT_1 
if  not Actor.Driving(0@)
then
    if  not ai_type == ai_type_killer
    then
        0085: ai_data0 = ai_target
        0085: ai_target = ai_get_closest_target_ped 
        if  gosub @check_target_can_character_shoot
        jf @listener_detector_can_character_kill_fail
        0085:  ai_target = ai_data0
        0470: $TEMPVAR_Z_COORD = actor 0@ current_weapon
        if and
            not $TEMPVAR_Z_COORD == 38 
            not $TEMPVAR_Z_COORD == 34
        then
            if or
              $TEMPVAR_Z_COORD > 16
              00F2:   actor 0@ near_actor ai_get_closest_target_ped radius 15.0 15.0 0 
            jf @listener_detector_foreach_next
            if 0104:   actor 0@ near_actor ai_get_closest_target_ped radius 80.0 80.0 180.0 sphere 0 
            jf @listener_detector_foreach_next       
        end
    end
else
    if or
      not Actor.DrivingVehicleType(0@, #RHINO)
      80F2: not  actor 0@ near_actor ai_get_closest_target_ped radius 15.0 15.0 0 
    jf @listener_detector_foreach_next
end
if or
    003B:   ai_data4 == ai_group_type
    051A:   actor 0@ damaged_by_actor ai_get_closest_target_ped
then
    goto @listener_detector_can_character_kill_success
end
if
056D:   actor ai_master_ped defined
then
    if  
        not actor.Dead(ai_master_ped)
    then
        if  051A:   actor ai_master_ped damaged_by_actor ai_get_closest_target_ped
        then
            goto @listener_detector_can_character_kill_success
        end
        if  Actor.Driving(ai_get_closest_target_ped)
        THEN
            $TEMPVAR_Z_COORD = actor.CurrentCar(ai_get_closest_target_ped)
            if  051C:   car $TEMPVAR_Z_COORD damaged_by_actor ai_master_ped
            then
                goto @listener_detector_can_character_kill_success
            end
        end
        if  003C:     $PLAYER_ACTOR == ai_master_ped
        then
            if  Player.WantedLevel($PLAYER_CHAR) > 0
            then
                if  ai_data4 == 6
                then
                    goto @listener_detector_can_character_kill_success
                end
            end 
        end   
    end
end
04DD: $TEMPVAR_Z_COORD = actor ai_get_closest_target_ped armour
if and
   ai_data4 == 27
    $TEMPVAR_Z_COORD < 30
then
    goto @listener_detector_can_character_kill_success
end


if 
    ai_group_type == group_friend
then
    if or
       ai_data4 == 25
       ai_data4 == 7
    then
        goto @listener_detector_can_character_kill_success
    end
end
if 
    ai_group_type == group_enemy1
then
    if or
       ai_data4 == 26
       ai_data4 == 8
       ai_data4 == 0
    then
        goto @listener_detector_can_character_kill_success
    end
end
if 
    ai_group_type == group_enemy2
then
    if or
       ai_data4 == 26
       ai_data4 == 25
       ai_data4 == 8
       ai_data4 == 7
       ai_data4 == 0
    then
        goto @listener_detector_can_character_kill_success
    end
end
if 
    ai_group_type == group_enemy3
then
    if or
       ai_data4 == 26
       ai_data4 == 6
       ai_data4 == 8
       ai_data4 == 7
       ai_data4 == 0
    then
        goto @listener_detector_can_character_kill_success
    end
end
if 
    ai_group_type == group_police
then
    if and 
        not Actor.Model(ai_get_closest_target_ped) == #LAPD1
        not Actor.Model(ai_get_closest_target_ped) == #sfPD1
        not Actor.Model(ai_get_closest_target_ped) == #lvPD1
        not Actor.Model(ai_get_closest_target_ped) == #laPDm1
        not Actor.Model(ai_get_closest_target_ped) == #swat
        not Actor.Model(ai_get_closest_target_ped) == #fbi
        not Actor.Model(ai_get_closest_target_ped) == #army
        not Actor.Model(ai_get_closest_target_ped) == #csher
    then
        if gosub @ai_is_target_firing_any_weapon
        then
            goto @listener_detector_can_character_kill_success
        end    
    end
    
     



end
if 
    ai_group_type == group_enemy4
then
    goto @listener_detector_can_character_kill_success
end
goto @listener_detector_foreach_next





:ai_is_target_firing_any_weapon
if and
   82E0:  not actor ai_get_closest_target_ped firing_weapon 
   not Actor.Animation(ai_get_closest_target_ped) == "FIGHTA_1"
   not Actor.Animation(ai_get_closest_target_ped) == "FIGHTA_2"
   not Actor.Animation(ai_get_closest_target_ped) == "FIGHTA_3"
   not Actor.Animation(ai_get_closest_target_ped) == "KNIFE_1"
   not Actor.Animation(ai_get_closest_target_ped) == "KNIFE_2"
   not Actor.Animation(ai_get_closest_target_ped) == "KNIFE_3"
jf @_Criminal_295
if and
   not Actor.Animation(ai_get_closest_target_ped) == "UZI_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "RIFLE_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "Bat_1"
   not Actor.Animation(ai_get_closest_target_ped) == "Bat_2"
   not Actor.Animation(ai_get_closest_target_ped) == "Bat_3"
   not Actor.Animation(ai_get_closest_target_ped) == "Bat_4"
   not Actor.Animation(ai_get_closest_target_ped) == "FightA_block"
   not Actor.Animation(ai_get_closest_target_ped) == "FIGHTIDLE"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "colt45_crouchfire"
   not Actor.Animation(ai_get_closest_target_ped) == "buddy_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "colt45_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "colt45_fire_2hands"
   not Actor.Animation(ai_get_closest_target_ped) == "shotgun_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "Silence_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "python_fire"
   not Actor.Animation(ai_get_closest_target_ped) == "WEAPON_throw"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "FightD_1"
   not Actor.Animation(ai_get_closest_target_ped) == "FightD_2"
   not Actor.Animation(ai_get_closest_target_ped) == "FightD_3"
   not Actor.Animation(ai_get_closest_target_ped) == "FightB_1"
   not Actor.Animation(ai_get_closest_target_ped) == "FightE_1"
   not Actor.Animation(ai_get_closest_target_ped) == "FightC_1"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "CSAW_1" 
   not Actor.Animation(ai_get_closest_target_ped) == "sword_1"       
   not Actor.Animation(ai_get_closest_target_ped) == "THEHULK_3"      
   not Actor.Animation(ai_get_closest_target_ped) == "CAR_pulloutL_LHS"
   not Actor.Animation(ai_get_closest_target_ped) == "CAR_pulloutL_RHS"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyLHS"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyLHS_Bwd"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyLHS_Fwd"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyRHS"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyRHS_Bwd"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyRHS_Fwd"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyTop_LHS"
   not Actor.Animation(ai_get_closest_target_ped) == "Gang_DrivebyTop_RHS"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "UZI_crouchfire"
   not Actor.Animation(ai_get_closest_target_ped) == "RIFLE_crouchfire"
   not Actor.Animation(ai_get_closest_target_ped) == "shotgun_crouchfire"
   not Actor.Animation(ai_get_closest_target_ped) == "Silence_crouchfire"
   not Actor.Animation(ai_get_closest_target_ped) == "FightShB"
   not Actor.Animation(ai_get_closest_target_ped) == "FightShF"
   not Actor.Animation(ai_get_closest_target_ped) == "FightSh_BWD"
   not Actor.Animation(ai_get_closest_target_ped) == "FightSh_FWD"
jf @_Criminal_295 
if and
   not Actor.Animation(ai_get_closest_target_ped) == "GunMove_BWD"
   not Actor.Animation(ai_get_closest_target_ped) == "GunMove_FWD"
   not Actor.Animation(ai_get_closest_target_ped) == "GunMove_R"
   not Actor.Animation(ai_get_closest_target_ped) == "GunMove_L"
jf @_Criminal_295 

059A:  return_false
return

:_Criminal_295
if
0104:   actor $PLAYER_ACTOR near_actor ai_get_closest_target_ped radius 60.0 60.0 60.0 sphere 0
jf @_Criminal_296
0485:  return_true
return

:_Criminal_296
059A:  return_false
return



    
:listener_detector_can_character_kill_if_is_player
if
   $Ignore_player == true
then
    if 003C:   ai_target == $PLAYER_ACTOR  // (int)
    then
        ai_target = -1 
    end
    goto @listener_detector_foreach_next
end
if or
    ai_group_type == group_enemy1
    ai_group_type == group_enemy2
    ai_group_type == group_enemy3
    Ai_group_type == group_enemy4
then
    goto @listener_detector_can_character_kill_success
end
if and
    not $officer_ignore_player == true
    ai_group_type == group_police
then
    if  Player.WantedLevel($PLAYER_CHAR) > police_system_standby
    then
        goto @listener_detector_can_character_kill_success
    end
end
if
   $officer_ignore_player == true
then
    if 003C:   ai_target == $PLAYER_ACTOR  // (int)
    then
        ai_target = -1 
    end
    goto @listener_detector_foreach_next
end
goto @listener_detector_foreach_next
    
                
    
    
    
    

:listener_detector_is_nearer_than_before 
if
   not Actor.Dead(0@)
then
    if and
        not Actor.Dead(ai_get_closest_target_ped)    //A
        not Actor.Dead(ai_get_closest_target_ped2)    //B
    then
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 0.0 0.0 
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_get_closest_target_ped with_offset 0.0 0.0 0.0  
        if  06BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 1 particle 0     //�����A�Ƿ����谭? ����ֱ��ѡB 
        then
            04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 0.0 0.0 
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_get_closest_target_ped2 with_offset 0.0 0.0 0.0  
            if  06BD:   no_obstacles_between $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD solid 1 car 0 actor 0 object 1 particle 0         //�����B�����谭? ����ֱ��ѡA  
            then
                04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 0.0 0.0 
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_get_closest_target_ped with_offset 0.0 0.0 0.0 
                050A: ai_data4 = distance_between_XYZ $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD        //��ȡ��ɫ��A�ľ��� 
                04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor ai_get_closest_target_ped2 with_offset 0.0 0.0 0.0 
                050A: ai_data5 = distance_between_XYZ $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 and $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD       //��ȡ��ɫ��B�ľ��� 
                if                                                           
                0035:   ai_data5 >= ai_data4  // (float)                                         // A �� B �Ǹ���? 
                then
                    0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped  
                else            
                    0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped2  
                end 
            else
                0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped   
            end 
        else
            0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped2   
        end
    else           //������һ�������� 
        if 
            Actor.Dead(ai_get_closest_target_ped)
        then
            0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped2  
        else
            0085: ai_get_closest_target_ped2 = ai_get_closest_target_ped  
        end
    end
end
goto @listener_detector_foreach_next 



:check_target_character_defined
if  056D:  actor ai_target defined 
jf @bool_return_false
ai_data4 = Actor.Health(ai_target)
if    ai_data4 >= 1       
jf @bool_return_false
return



:listener_target_detector_start
ai_get_closest_target_id = 0 
ai_get_closest_target_ped = -1
0A8D: ai_get_closest_target_memory = read_memory 12010640 size 4 virtual_protect 1 
ai_get_closest_target_memory += 4 
0A8D: ai_get_closest_target_memory = read_memory ai_get_closest_target_memory size 4 virtual_protect 1 
return

:listener_detector_foreach_in_world_npcs
if or
    Actor.Dead(ai_target) 
    next_get_target_wait >= 0
jf @listener_detector_get_target_completed



0A8D: ai_get_closest_target_ped = read_memory ai_get_closest_target_memory size 1 virtual_protect 1 
ai_get_closest_target_memory += 1 
if and
  ai_get_closest_target_ped >= 0 
  128 > ai_get_closest_target_ped 
jf @listener_detector_foreach_next
005A: ai_get_closest_target_ped += ai_get_closest_target_id // (int) 

if  803C:   not  0@ == ai_get_closest_target_ped //
jf @listener_detector_foreach_next
if  056D:   actor ai_get_closest_target_ped defined
jf @listener_detector_foreach_next
if  not Actor.Dead(ai_get_closest_target_ped)
jf @listener_detector_foreach_next
if 80FE: not  actor ai_get_closest_target_ped sphere 0 in_sphere 0.0 0.0 0.0 radius 20.0 20.0 10000.0
jf @listener_detector_foreach_next
goto @listener_detector_found_target

:listener_detector_foreach_next
ai_get_closest_target_id += 256 
if  ai_get_closest_target_id > 35584 
jf @listener_detector_foreach_in_world_npcs
next_get_target_wait = -2
if  056D:   actor ai_get_closest_target_ped2 defined
then
    if  not actor.Dead(ai_get_closest_target_ped2)
    then
        0085: ai_target = ai_get_closest_target_ped2
    end
end
goto @listener_detector_get_target_completed

:ai_choose_the_target

return





:function_character_fallback_when_target_closes

if and
     not function_character_current_task_id == function_character_search_shelter_1 
     not function_character_current_task_id == function_character_search_shelter_2
     not function_character_current_task_id == function_character_search_shelter_3
     not function_character_current_task_id == function_character_search_shelter_4
    not ai_master_ped > 4
then
    0A8D: $TEMPVAR_FLOAT_1 = read_memory 5499202 size 2 virtual_protect 0
    if
       not $TEMPVAR_FLOAT_1 == 370081
    then
        if  0104:   actor 0@ near_actor ai_target radius 10.0 10.0 2.0 sphere 0
        then
            
            0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -32767 32767
            if 
                $TEMPVAR_FLOAT_1 > 0
            then
                $TEMPVAR_FLOAT_1 = 15.0
            else
                $TEMPVAR_FLOAT_1 = -15.0
            end
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor 0@ with_offset $TEMPVAR_FLOAT_1 -15.0 0.0
            function_character_current_task_id = ai_task_firing
            gosub @function_character_go_to_postion_with_AI
    
    
    
            if  not ai_data6 == -7
            jf @bool_return_false
        end
    else
        goto @0251512850238068
    end
else
    :0251512850238068
    if  0104:   actor 0@ near_actor ai_target radius 4.0 4.0 2.0 sphere 0
    then
        0208: $TEMPVAR_FLOAT_1 = random_float_in_ranges -1.0 1.0
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor 0@ with_offset $TEMPVAR_FLOAT_1 -5.0 0.0
        function_character_current_task_id = ai_task_firing
        gosub @function_character_go_to_postion_with_AI
        if  not ai_data6 == -7
        jf @bool_return_false
    end            
end
goto @bool_return_true


:function_character_chases_the_target
if and
     not function_character_current_task_id == function_character_search_shelter_1 
     not function_character_current_task_id == function_character_search_shelter_2
     not function_character_current_task_id == function_character_search_shelter_3
     not function_character_current_task_id == function_character_search_shelter_4
     not ai_master_ped > 4
then
    0A8D: $TEMPVAR_FLOAT_1 = read_memory 5499202 size 2 virtual_protect 0
    if
       not $TEMPVAR_FLOAT_1 == 370081
    then
        if  8104:  not actor 0@ near_actor ai_target radius 20.0 20.0 20.0 sphere 0
        then
            
            0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -32767 32767
            if 
                $TEMPVAR_FLOAT_1 > 0
            then
                $TEMPVAR_FLOAT_1 = 10.0
            else
                $TEMPVAR_FLOAT_1 = -10.0
            end
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD from_actor ai_target with_offset $TEMPVAR_FLOAT_1 0.0 0.0
            function_character_current_task_id = ai_task_firing
            gosub @function_character_go_to_postion_with_AI
            if  not ai_data6 == -7
            jf @bool_return_false
        end
    end
else        
end
goto @bool_return_true








                               






:function_character_remove_as_ped 
if ai_clean_type == clean_like_ped
then

    :ai_clean_local
    if 89DE:  not actor 0@ entering_car
    then
        0889: store_actor 0@ center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
        
        if
            not Actor.Driving(0@) 
        then
            
            if and
            80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
            8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 72.0 72.0 1000.0 sphere 0
            then
                gosub @character_reset_all_animation
                Actor.DestroyInstantly(0@)
                gosub @script_remove_all_sub_object
                end_thread
            end 
        else
            if or
                04A9:   actor 0@ driving_heli
               Actor.DrivingPlane(0@)
            then
                if and
                    80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
                    8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 1000.0 1000.0 1000.0 sphere 0
                then
                    gosub @character_reset_all_animation
                    Actor.DestroyInstantly(0@)
                    gosub @script_remove_all_sub_object
                    end_thread
                end        
            else
                if and
                80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
                8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 130.0 130.0 1000.0 sphere 0
                then
                    gosub @character_reset_all_animation
                    Actor.DestroyInstantly(0@)
                    gosub @script_remove_all_sub_object
                    end_thread
                end 
                 
            end
                
      
        end    
        
    end
end
return

:function_character_remove_as_mission_actor 
if ai_clean_type == clean_like_ped_when_mission_end
then
    if $ONMISSION == 0
    then
        gosub @ai_clean_local
    end
end
return

:function_character_remove_when_far_away
if ai_clean_type == clean_far_ped
then
    if 89DE:  not actor 0@ entering_car
    then
        0889: store_actor 0@ center_of_body_position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3
        if
            not Actor.Driving(0@) 
        then
            if and
            80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
            8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 150.0 150.0 1000.0 sphere 0
            then
                gosub @character_reset_all_animation
                Actor.DestroyInstantly(0@)
                gosub @script_remove_all_sub_object
                end_thread
            end 
        else
            if or
                04A9:   actor 0@ driving_heli
               Actor.DrivingPlane(0@)
            then
                if and
                    80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
                    8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 1000.0 1000.0 1000.0 sphere 0
                then
                    gosub @character_reset_all_animation
                    Actor.DestroyInstantly(0@)
                    gosub @script_remove_all_sub_object
                    end_thread
                end        
            else
                if and
                80C2:   not sphere_onscreen $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 5.0
                8104:   not actor $PLAYER_ACTOR near_actor 0@ radius 200.0 200.0 1000.0 sphere 0
                then
                    gosub @character_reset_all_animation
                    Actor.DestroyInstantly(0@)
                    gosub @script_remove_all_sub_object
                    end_thread
                end             
          
            end 
        end    
    end
end
return



:check_character_defined
if  856D: not actor 0@ defined 
then
    gosub @script_remove_all_sub_object
    end_thread
end
if 003C:   $script_clean_ai_with == 0@  // (int)
then
    $script_clean_ai_with = 0
    gosub @script_remove_all_sub_object
    end_thread
end

if or
    not Player.Defined($PLAYER_CHAR) 
    856D:   actor $PLAYER_ACTOR defined
then
    wait 6000
    if or
        not Player.Defined($PLAYER_CHAR) 
        856D:   actor $PLAYER_ACTOR defined
    then
        gosub @script_remove_all_sub_object
        end_thread
    end
end


return

:script_remove_all_sub_object
marker.Disable(ai_marker)
object.Destroy(ai_object)
if or          
    ai_data1 < -16 
    ai_data1 > 16
then
    061B: remove_references_to_AS_pack ai_data1
end 
if or
    ai_maker > 16
    ai_maker < -16
then
    065C: release_decision_maker ai_maker
end
if and
   $get_version_dec > 0.00
   $get_version_dec < 10.00
then
    $current_threads -= 1
    $current_humans -= 1 

end
   
return 




:check_character_dead
if  056D:   actor 0@ defined
jf @function_remove_this_ai_script
if  Actor.Dead(0@)
then
    goto @ai_dies_clean
end
ai_data3 = Actor.Health(0@)
if    ai_data3 <= 1                       
then             // human remove One from debug
    Actor.Health(0@) = 100
    WAiT 0
    if
    056D:   actor 0@ defined
    jf @function_remove_this_ai_script
    aI_data1 = 0
    if  Actor.Animation(0@) == "KD_left"
    then
        ai_data1 = 1
    end 
    if  Actor.Animation(0@) == "KD_right"
    then
        ai_data1 = 2
    end 
    if  Actor.Animation(0@) == "KO_shot_face"
    then
        ai_data1 = 3
    end 
    if  Actor.Animation(0@) == "KO_shot_front"
    then
        ai_data1 = 4
    end 
    if  Actor.Animation(0@) == "KO_skid_back"
    then
        ai_data1 = 5
    end 
    if  Actor.Animation(0@) == "KO_skid_front"
    then
        ai_data1 = 6
    end 
    if  Actor.Animation(0@) == "KO_spin_L"
    then
        ai_data1 = 7
    end 
    if  Actor.Animation(0@) == "KO_spin_R"
    then
        ai_data1 = 8
    end 

    0555: remove_weapon 31 from_actor 0@
    gosub @character_reset_all_animation

        if ai_data1 == 0
        then
            0829: actor 0@ perform_animation "KO_skid_front" IFP_file "PED" rate 4.0 time 0 and_dies
        end    
        if ai_data1 == 1
        then
            0829: actor 0@ perform_animation "KD_left" IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 2 
        then
            0829: actor 0@ perform_animation "KD_right" IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 3
        then
            0829: actor 0@ perform_animation "KO_shot_face"  IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 4
        then
            0829: actor 0@ perform_animation "KO_skid_front"  IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 5
        then
            0829: actor 0@ perform_animation "KO_skid_front" IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 6
        then
            0829: actor 0@ perform_animation "KO_spin_L" IFP_file "PED" rate 4.0 time 0 and_dies
        end  
        if ai_data1 == 7
        then
            0829: actor 0@ perform_animation "KO_spin_R" IFP_file "PED" rate 4.0 time 0 and_dies
        end      

                                 
    :ai_dies_clean
    gosub @script_remove_all_sub_object
    if
    056D:   actor 0@ defined
    then
        if Actor.Driving(0@)
        then
            10@ = Actor.CurrentCar(0@)
            Car.SetDriverBehaviour(10@, Nowhere)
            00AE: set_car 10@ traffic_behaviour_to 2
            06C7: AS_actor 0@ driver_of_car 10@ perform_action 7 timelimit 3000
        end
    
    end
    
    
    if  ai_clean_type == clean_like_ped
    then
        wait 5000
        Actor.DestroyWithFade(0@)
        end_thread
    end
    if  ai_clean_type == clean_like_ped_when_mission_end
    then
        while not $ONMISSION == 0
            wait 0
        end // while
        wait 5000
        Actor.DestroyWithFade(0@)
        end_thread
    end
    if  ai_clean_type == clean_like_ped_and_die_remove
    then
        wait 5000
        Actor.DestroyWithFade(0@)
        end_thread
    end    
    if  ai_clean_type == clean_far_ped
    then
        wait 5000
        Actor.DestroyWithFade(0@)
        end_thread
    end  
    end_thread
end
return

    
:function_remove_this_ai_script
gosub @script_remove_all_sub_object
end_thread



:script_add_necessary_sub_object
if  803B:   not  0@ == $Player_Actor // (int) 
then  
    087F: set_actor 0@ never_leave_group 0
    06C9: remove_actor 0@ from_group
    08ED: remove_actor 0@ from_dialogue_mode
    0489: set_actor 0@ muted 1
    04D8: set_actor 0@ drowns_in_water 0
    0946: set_actor 0@ actions_uninterupted_by_weapon_fire 1
    0961: set_actor 0@ keep_tasks_after_cleanup 1
    0982: set_actor 0@ stay_in_car_when_dead 1
    077C: clear_actor 0@ acquaintance 0 to_all_pedtypes // see ped.dat
    077C: clear_actor 0@ acquaintance 1 to_all_pedtypes // see ped.dat
    077C: clear_actor 0@ acquaintance 2 to_all_pedtypes // see ped.dat
    077C: clear_actor 0@ acquaintance 3 to_all_pedtypes // see ped.dat
    077C: clear_actor 0@ acquaintance 4 to_all_pedtypes // see ped.dat
    

    09B5: set_actor 0@ signal_after_kill 0
end


ai_object = Object.Create(1318, 0, 0, 0)
object.KeepInMemory(ai_object, true)
object.CollisionDetection(ai_object, false)
0750: set_object ai_object visibility 0
Actor.StorePos(0@, ai_point_x, ai_point_y, AI_POINT_Z)
next_get_target_wait = 0
ai_maker = 0
ai_marker = Marker.CreateAboveActor(0@)
089F: get_actor 0@ pedtype_to $TEMPVAR_FLOAT_1


if and
    not ai_group_type == group_police
     not ai_group_type == group_ped
then
    018B: set_marker ai_marker radar_mode 2
    if or
        ai_group_type == group_friend
        ai_group_type == group_familly
        
        $TEMPVAR_FLOAT_1 == 26
        003B:   ai_master_ped == $Player_Actor
    then
        07E0: set_marker ai_marker type_to 1
        0770: set_actor 0@ target_priority 0
        0568: set_actor 0@ untargetable 1

    end
else
    Marker.Disable(ai_marker)
end
060F: set_actor 0@ melee_accuracy_to 100.0 

function_character_current_task_id = 0

039E: set_actor 0@ locked 1 while_in_car
0526: set_actor 0@ stay_in_car_when_jacked  1
060B: set_actor 0@ decision_maker_to 32
special_command = 0
0A96: $TEMPVAR_FLOAT_1 = actor 0@ struct 
$TEMPVAR_FLOAT_1 += 1350
0A8C: write_memory $TEMPVAR_FLOAT_1 size 4 value 1350 virtual_protect 1 
0A8D: $TEMPVAR_FLOAT_2 = read_memory $TEMPVAR_FLOAT_1 size 4 virtual_protect 0 

Actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
08E5: get_actor_in_sphere $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 radius 1.0 handle_as ai_data4
if  003B:   0@ == ai_data4  // (int)
then
    ai_clean_type = clean_like_ped
else
    Actor.RemoveReferences(ai_data4)
end               
if ai_clean_type == 2
then
    Actor.RemoveFromMissionCleanupList(0@)
end                              
if 
     Actor.DrivingPlane(0@)
then
    $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@)
    $TEMPVAR_Z_COORD += 120.0
    0819: $TEMPVAR_FLOAT_3 = actor 0@ distance_from_ground
    if
        $TEMPVAR_FLOAT_3 < 80.0
    then

        03CD: disable_car $TEMPVAR_FLOAT_1 stuck_check 
        0742: set_plane $TEMPVAR_FLOAT_1 unknown_trajectory 1.5 
        0745: set_hydra $TEMPVAR_FLOAT_1 thrust_to_horizontal 
        
        08E6: set_plane $TEMPVAR_FLOAT_1 landing_gear 0
        if  gosub @check_target_character_defined
        then
            0710: plane $TEMPVAR_FLOAT_1 follow_actor ai_target follow_car -1 radius 120.0 
        else
            04D2: set_plane $TEMPVAR_FLOAT_1 fly_autopilot_around_point 0.0 0.0 100.0 altitude_between 120.0 and 150.0 
        end
        
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 2000                
        Car.StorePos($TEMPVAR_FLOAT_1, $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD )
        02CE: $TEMPVAR_Z_COORD = ground_z_at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD
        $TEMPVAR_Z_COORD += 66.0
        Car.PutAt($TEMPVAR_FLOAT_1,  $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD)
        Car.SetSpeedInstantly($TEMPVAR_FLOAT_1, 2.0)
        
        
        return
    end
end       
return


:check_character_is_not_reloading
if and
  not Actor.Animation(0@) == "COLT45_RELOAD"
  not Actor.Animation(0@) == "SILENCED_RELOAD"
  not Actor.Animation(0@) == "PYTHON_RELOAD"
  not Actor.Animation(0@) == "BUDDY_RELOAD"
  not Actor.Animation(0@) == "UZI_RELOAD"
  not Actor.Animation(0@) == "TEC_RELOAD"
  not Actor.Animation(0@) == "RIFLE_LOAD"
jf @bool_return_false 
goto @bool_return_true 



                      
:check_character_is_not_be_hit
if and
   not Actor.Animation(0@) == "HitA_1"
   not Actor.Animation(0@) == "HitA_2"
   not Actor.Animation(0@) == "HitA_3"
   not Actor.Animation(0@) == "HIT_behind"
   not Actor.Animation(0@) == "HIT_back"
   not Actor.Animation(0@) == "HIT_front"     
   not Actor.Animation(0@) == "HIT_L"
   not Actor.Animation(0@) == "HIT_R"        
   
jf @bool_return_false 
if and                                 
    not Actor.Animation(0@) == "abseil" 
    not Actor.Animation(0@) == "ARRESTgun" 
    not Actor.Animation(0@) == "EV_dive" 
    not Actor.Animation(0@) == "EV_step"
    not Actor.Animation(0@) == "FALL_glide"
    not Actor.Animation(0@) == "getup"
    not Actor.Animation(0@) == "getup_front"
    not Actor.Animation(0@) == "HIT_GUN_BUTT"
jf @bool_return_false 
if and                                 
    not Actor.Animation(0@) == "Turn_L" 
    not Actor.Animation(0@) == "Turn_R" 
    not Actor.Animation(0@) == "turn_180" 
    not Actor.Animation(0@) == "FALL_fall" 
jf @bool_return_false 
if and                                 
    not Actor.Animation(0@) == "KILL_Knife_Ped_Damage" 
    not Actor.Animation(0@) == "KILL_Knife_Player" 
    not Actor.Animation(0@) == "FightC_2" 
jf @bool_return_false 
goto @bool_return_true                          
                       
                       
                           
:check_character_is_not_on_car_task
if and  
   not Actor.Animation(0@) == "CAR_align_LHS" 
   not Actor.Animation(0@) == "CAR_align_RHS"
   not Actor.Animation(0@) == "CAR_close_LHS"    
   not Actor.Animation(0@) == "CAR_close_RHS"   
   not Actor.Animation(0@) == "CAR_crawloutRHS" 
   not Actor.Animation(0@) == "CAR_doorlocked_LHS"
   not Actor.Animation(0@) == "CAR_doorlocked_RHS"    
   not Actor.Animation(0@) == "CAR_getinL_LHS"   
jf @bool_return_false 
if and  
   not Actor.Animation(0@) == "CAR_getinL_RHS" 
   not Actor.Animation(0@) == "CAR_getin_LHS"
   not Actor.Animation(0@) == "CAR_getin_RHS"    
   not Actor.Animation(0@) == "CAR_jackedLHS"   
   not Actor.Animation(0@) == "CAR_jackedRHS" 
   not Actor.Animation(0@) == "CAR_jumpin_LHS"
   not Actor.Animation(0@) == "CAR_LjackedLHS"    
   not Actor.Animation(0@) == "CAR_LjackedRHS"   
jf @bool_return_false 
if and  
   not Actor.Animation(0@) == "CAR_Lshuffle_RHS" 
   not Actor.Animation(0@) == "CAR_open_LHS"
   not Actor.Animation(0@) == "CAR_open_RHS"    
   not Actor.Animation(0@) == "CAR_pulloutL_LHS"   
   not Actor.Animation(0@) == "CAR_pulloutL_RHS" 
   not Actor.Animation(0@) == "CAR_pullout_LHS"
   not Actor.Animation(0@) == "CAR_pullout_RHS"    
   not Actor.Animation(0@) == "CAR_Qjacked"       
jf @bool_return_false 
if and  
   89DE:  not actor 0@ entering_car
   not Actor.Animation(0@) == "CAR_rollout_LHS" 
   not Actor.Animation(0@) == "CAR_rollout_RHS"  
jf @bool_return_false    
goto @bool_return_true


:check_character_is_not_climbing
if and
   not Actor.Animation(0@) == "FALL_glide" 
   not Actor.Animation(0@) == "FALL_land" 
   not Actor.Animation(0@) == "flee_lkaround_01" 
jf @bool_return_false                               
if and                                         
   not Actor.Animation(0@) == "CLIMB_idle" 
   not Actor.Animation(0@) == "CLIMB_jump"
   not Actor.Animation(0@) == "CLIMB_jump2fall"    
   not Actor.Animation(0@) == "CLIMB_jump_B"   
   not Actor.Animation(0@) == "CLIMB_Pull" 
   not Actor.Animation(0@) == "CLIMB_Stand"
   not Actor.Animation(0@) == "CLIMB_Stand_finish"      
jf @bool_return_false 
goto @bool_return_true



:bool_return_true
0485:  return_true
return

:bool_return_false 
059A:  return_false
return












0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -30 30
while true
    if or 
        $TEMPVAR_FLOAT_1 > 10
        $TEMPVAR_FLOAT_1 < 10
    then
        break
    end
end // while
$TEMPVAR_FLOAT_1 *= 2
:AI_GoRandomPoint
0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -20 20
008F: $TEMPVAR_FLOAT_1 = integer $TEMPVAR_FLOAT_1 to_float
04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor 0@ with_offset $TEMPVAR_FLOAT_1 120.0 0.0
03D3: get_route_nearest_for $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD store_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD Z_angle_to $TEMPVAR_ANGLE
jump @function_character_go_to_postion_with_AI

:AI_GoPlayerTargetPoint
0AB6: store_target_marker_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD // IF and SET
jump @function_character_go_to_postion_with_AI




:return_to_update
ai_data6 = -7
return



:function_character_attaack_target_with_weapon

089F: get_actor 0@ pedtype_to $TEMPVAR_FLOAT_1
if or
    ai_group_type == group_friend
    ai_group_type == group_familly
    $TEMPVAR_FLOAT_1 == 26
    003B:   ai_master_ped == $Player_Actor
jf @function_character_attaack_target_with_weapon_yes
if and  
    056D:   actor ai_target defined
    803B: not  ai_target == $PLAYER_ACTOR  // (int)
then
    if not Actor.Dead(AI_TARGET)
    then
        if  8104:  not actor $PLAYER_ACTOR near_actor ai_target radius 1.7 1.7 1.7 sphere 0
        jf @function_character_attaack_target_with_weapon_yes
    end
end     
for ai_data4 = 1 to 60 // step 1
   0093: ai_data6 = integer ai_data4 to_float
   if and
       02A0:   actor $PLAYER_ACTOR stopped
       02A0:   actor 0@ stopped
   then
        $TEMPVAR_ANGLE = 0.6
   else
        $TEMPVAR_ANGLE = 1.2
   end
   04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3  from_actor 0@ with_offset 0.0 ai_data6 0.0
   if 80FE: not actor $PLAYER_ACTOR sphere 0 in_sphere $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 radius $TEMPVAR_ANGLE $TEMPVAR_ANGLE 100.0
   jf @function_character_attaack_target_with_weapon_no   
end // for

:function_character_attaack_target_with_weapon_yes
0209: $TEMPVAR_ANGLE = random_int_in_ranges 0 2000
if $TEMPVAR_ANGLE > 1000
jf @function_character_attaack_target_with_weapon_no

00A0: store_actor ai_target position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3     
0668: AS_actor 0@ rotate_and_shoot_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 3000 ms
goto @bool_return_true

:function_character_attaack_target_with_weapon_no
00A0: store_actor ai_target position_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3     
0667: AS_actor 0@ aim_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3  3000 ms
goto @bool_return_false

:function_reset_plane
return
if 
     Actor.DrivingPlane(0@)
then
    $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@) 
    0819: $TEMPVAR_FLOAT_3 = actor 0@ distance_from_ground
    if
        $TEMPVAR_FLOAT_3 > 20.0
    then
        //07D5: set_car $TEMPVAR_FLOAT_1 velocity_in_direction_XYZ 0.0 0.0 80.0 rotation_velocitiesXY 0.0 0.0 unk 0.0
      
        08E6: set_plane $TEMPVAR_FLOAT_1 landing_gear 0
    else
        08E6: set_plane $TEMPVAR_FLOAT_1 landing_gear 1
    end 
end 
return


:function_character_go_to_postion_with_AI
          
    
                
if not ai_type == ai_type_locked
jf @bool_return_true
01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
0085: $TEMPVAR_FLOAT_2 = ai_move_time
$TEMPVAR_FLOAT_2 += 500
if 001D:   $TEMPVAR_FLOAT_1 > $TEMPVAR_FLOAT_2  // (int)
jf @bool_return_true
actor.StorePos(0@, $TEMPVAR_FLOAT_1, $TEMPVAR_FLOAT_2, $TEMPVAR_FLOAT_3)
092E: get_water_height_at $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 ignore_waves 0 store_to ai_data4
ai_data4 += ai_swimming_water_height
if  0025:   ai_data4 > $TEMPVAR_FLOAT_3  // (float)
then
    gosub @character_reset_all_animation
    07E1: AS_actor 0@ swim_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD
    0A28: set_actor 0@ swimming_speed_to 2.5
    ai_move_time = -600
    return
end
            
        
if  Actor.Driving(0@)
then
    $TEMPVAR_FLOAT_1 = Actor.CurrentCar(0@)
    0085: $tempvar_Actor_Car = $TEMPVAR_FLOAT_1
    if  not Car.Wrecked($TEMPVAR_FLOAT_1)
    then
        046C: $TEMPVAR_FLOAT_2 = car $TEMPVAR_FLOAT_1 driver
        if  003B:   $TEMPVAR_FLOAT_2 == 0@  // (int)
        then
            if and
                0975:   car $TEMPVAR_FLOAT_1 emergency_vehicle
                8ABD:   not vehicle $TEMPVAR_FLOAT_1 siren_on
                056D:   actor ai_target defined
            then
                0397: enable_car $TEMPVAR_FLOAT_1 siren 1
            end
            060B: set_actor 0@ decision_maker_to 1
            if 
                04A9:   actor 0@ driving_heli 
            then
                $TEMPVAR_Z_COORD += 30.0
                04A2: set_heli $TEMPVAR_FLOAT_1 fly_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD altitude_between 40.0 and 50.0  
                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 2000
                return
            end
            
            if 
                 Actor.DrivingPlane(0@)
            then
                Car.SetImmunities($TEMPVAR_FLOAT_1, 0, 0, 0, 0, 1)
                $TEMPVAR_Z_COORD += 120.0
                0819: $TEMPVAR_FLOAT_3 = actor 0@ distance_from_ground
                if
                    $TEMPVAR_FLOAT_3 < 80.0
                then

                    03CD: disable_car $TEMPVAR_FLOAT_1 stuck_check 
                    0742: set_plane $TEMPVAR_FLOAT_1 unknown_trajectory 1.5 
                    0745: set_hydra $TEMPVAR_FLOAT_1 thrust_to_horizontal 
                    
                    08E6: set_plane $TEMPVAR_FLOAT_1 landing_gear 0
                    if  gosub @check_target_character_defined
                    then
                        0710: plane $TEMPVAR_FLOAT_1 follow_actor ai_target follow_car -1 radius 100.0 
                    else
                        04D2: set_plane $TEMPVAR_FLOAT_1 fly_autopilot_around_point $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD altitude_between 120.0 and 150.0 
                    end
                    
                    01BD: ai_move_time = current_time_in_ms
                    ai_move_time += 2000                
                    Car.StorePos($TEMPVAR_FLOAT_1, $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD )
                    02CE: $TEMPVAR_Z_COORD = ground_z_at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD
                    $TEMPVAR_Z_COORD += 66.0
                    Car.PutAt($TEMPVAR_FLOAT_1,  $TEMPVAR_X_COORD, $TEMPVAR_Y_COORD, $TEMPVAR_Z_COORD)
                    Car.SetSpeedInstantly($TEMPVAR_FLOAT_1, 2.0)
                    
                    
                    return
                end
                
                
                $TEMPVAR_Z_COORD += 60.0
                03A2: set_car $TEMPVAR_FLOAT_1 action 3 
                0742: set_plane $TEMPVAR_FLOAT_1 unknown_trajectory 1.5 
                0745: set_hydra $TEMPVAR_FLOAT_1 thrust_to_horizontal 
                
                08E6: set_plane $TEMPVAR_FLOAT_1 landing_gear 0
                if  gosub @check_target_character_defined
                then
                    0710: plane $TEMPVAR_FLOAT_1 follow_actor ai_target follow_car -1 radius 100.0 
                else
                    04D2: set_plane $TEMPVAR_FLOAT_1 fly_autopilot_around_point $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD altitude_between 120.0 and 150.0 
                end
                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 2000
                return
            end

            if 
            
            04A7:  actor 0@ driving_boat 
            then
               02D3: boat $TEMPVAR_FLOAT_1 sail_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD
               00AE: set_car $TEMPVAR_FLOAT_1 traffic_behaviour_to 2 
               02DB: set_boat $TEMPVAR_FLOAT_1 speed_to 50.0 
                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 2000
               return
            end
            if 
            09AE:   actor 0@ driving_train 
            then 
                06DC: set_train $TEMPVAR_FLOAT_1 acc 20.0 
                06DD: set_train $TEMPVAR_FLOAT_1 speed 20.0 
                09CF: set_train $TEMPVAR_FLOAT_1 stop_at_stations 1 
                01BD: ai_move_time = current_time_in_ms
                ai_move_time += 2000
                return
            end
            gosub @character_reset_all_animation
            Car.SetDriverBehaviour($TEMPVAR_FLOAT_1, FollowRoad)
            00AE: set_car $TEMPVAR_FLOAT_1 traffic_behaviour_to 2 
            0423: set_car $TEMPVAR_FLOAT_1 improved_handling_to 2.0 // (float) 
            Car.SetDriverBehaviour($TEMPVAR_FLOAT_1, FollowRoad)
            04E0: car $TEMPVAR_FLOAT_1 abandon_path_radius 50 
                
            01BD: ai_move_time = current_time_in_ms
            ai_move_time += 2000
            
            if  056D:   actor ai_target defined
            then
                if not Actor.Dead(ai_target)  
                then
                    05D1: AS_actor 0@ drive_car $TEMPVAR_FLOAT_1 to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD speed 40.0 1 model #NULL 2 
                else
                    05D1: AS_actor 0@ drive_car $TEMPVAR_FLOAT_1 to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD speed 12.0 1 model #NULL 0
                end
            else
                if or
                    special_command == 59
                    special_command == 60
                then
                    05D1: AS_actor 0@ drive_car $TEMPVAR_FLOAT_1 to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD speed 40.0 1 model #NULL 2
                    0397: enable_car $TEMPVAR_FLOAT_1 siren 1
                else
                    05D1: AS_actor 0@ drive_car $TEMPVAR_FLOAT_1 to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD speed 12.0 1 model #NULL 0
                end
            end    
        end
        return
    end
    
end

01BD: $TEMPVAR_FLOAT_1 = current_time_in_ms
0085: $TEMPVAR_FLOAT_2 = ai_move_time
$TEMPVAR_FLOAT_2 += 500

if 001D:   $TEMPVAR_FLOAT_1 > $TEMPVAR_FLOAT_2  // (int)
jf @bool_return_false
//gosub @AI_path_load
if or  
    function_character_current_task_id == ai_task_firing
    function_character_current_task_id == ai_task_aiming
    function_character_current_task_id ==  function_character_search_shelter_1
    function_character_current_task_id ==  function_character_search_shelter_2
    function_character_current_task_id ==  function_character_search_shelter_3
    function_character_current_task_id ==  function_character_search_shelter_4
then 
    if  gosub @ai_is_around_path_can_not_pass
    then
        if gosub @ai_get_around_path_can_be_pass
        jf @bool_return_false
    end    
    if  gosub @check_character_is_not_reloading
    then
        0A8D: $TEMPVAR_FLOAT_1 = read_memory 5499202 size 2 virtual_protect 0
        if
           not $TEMPVAR_FLOAT_1 == 370081
        then
        
            
            if  gosub  @check_character_current_wepaon_can_shoot
            then
                //0AB1: call_scm_func @Task_actor_random_move 2 0@ ai_target
                if
                056D:   actor ai_target defined
                then
                    if  not Actor.Dead(ai_target)
                    then
                        if  gosub @check_target_can_character_shoot
                        then
                            if gosub @start_check_can_shoot_at_target_without_friend //?
                            then
                            
                                gosub @character_reset_all_animation_no_crouch 
                                gosub @TAMAI_Awake_weapon_flag_to_rife  
                                0637: AS_actor 0@ go $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 4 turn_radius 0.5 stop_radius 1.0 look_at_actor ai_target 
                                
                                
                                //06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 actor ai_target with_offset 0.0 0.0 0.0
                                {0AB1: call_scm_func @get_target_angle_now 2 0@ ai_target to $TEMPVAR_FLOAT_1
                                Actor.Angle(0@) = $TEMPVAR_FLOAT_1
                                0812: AS_actor 0@ perform_animation "GunMove_fWD" IFP "PED" framedelta 1000.0 loopA 1 lockX 1 lockY 1 lockF 0 time 2000  // versionB
                                0812: AS_actor 0@ perform_animation "GunMove_r" IFP "PED" framedelta 1000.0 loopA 1 lockX 1 lockY 1 lockF 0 time 2000  // versionB
                                0812: AS_actor 0@ perform_animation "GunMove_l" IFP "PED" framedelta 1000.0 loopA 1 lockX 1 lockY 1 lockF 0 time 2000  // versionB
                                0812: AS_actor 0@ perform_animation "GunMove_bWD" IFP "PED" framedelta 1000.0 loopA 1 lockX 1 lockY 1 lockF 0 time 2000  // versionB          }
                                01BD: ai_move_time = current_time_in_ms
                                ai_move_time += 1250
                                gosub @TAMAI_Awake_weapon_flag_to_current_weapon
                            else
                                gosub @character_reset_all_animation_no_crouch 
                                gosub @TAMAI_Awake_weapon_flag_to_rife    
                                  
                                06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 actor ai_target with_offset 0.0 0.0 0.0
                                01BD: ai_move_time = current_time_in_ms
                                ai_move_time += 1250
                                gosub @TAMAI_Awake_weapon_flag_to_current_weapon                    
                            end
                        else     
                            gosub @character_reset_all_animation_no_crouch 
                            gosub @TAMAI_Awake_weapon_flag_to_rife      
                            06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 actor ai_target with_offset 0.0 0.0 0.0
                            01BD: ai_move_time = current_time_in_ms
                            ai_move_time += 1250
                            gosub @TAMAI_Awake_weapon_flag_to_current_weapon
                        end  
                    else
                    
                        :AI_gotosystem_b13
                        gosub @character_reset_all_animation_no_crouch 
                        gosub @TAMAI_Awake_weapon_flag_to_rife 
                        04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_actor 0@ with_offset 2.0 16.0 1.0                     
                        06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 0.5 actor -1 with_offset $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3
                        01BD: ai_move_time = current_time_in_ms
                        ai_move_time += 1250
                        gosub @TAMAI_Awake_weapon_flag_to_current_weapon
                    end   
                else
                    jump @AI_gotosystem_b13
                end
                if  not Actor.Dead(0@)
                then
                    0393: actor 0@ perform_animation "GunMove_L" at 2.4 times_normal_rate 
                    0393: actor 0@ perform_animation "GunMove_R" at 2.4 times_normal_rate 
                    0393: actor 0@ perform_animation "GunMove_BWD" at 2.4 times_normal_rate 
                    0393: actor 0@ perform_animation "GunMove_FWD" at 2.4 times_normal_rate 
                    0393: actor 0@ perform_animation "Swim_Breast" at 2.4 times_normal_rate 
                    0393: actor 0@ perform_animation "SWIM_crawl" at 2.4 times_normal_rate  
                end
                return
            else
                function_character_current_task_id = ai_task_fighting
            end
        else

        end
   
        
    end
end
if or
    function_character_current_task_id == ai_task_fighting
    function_character_current_task_id == ai_task_go_to_target
    function_character_current_task_id == ai_task_go_to_target_in_car
    function_character_current_task_id == 0
    function_character_current_task_id == ai_idle_1
    function_character_current_task_id == ai_idle_2
    function_character_current_task_id == ai_idle_3
    function_character_current_task_id == ai_playing_task_pack
then

    
    gosub @character_reset_all_animation
    if and
        not Actor.Model(0@) == 163
        not Actor.Model(0@) == #SPECIAL09 
        80FE:  not actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 20.0 20.0 20.0
    then
        for ai_data4 = 0 to 40 // step 1
            Actor.StorePos(0@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
            0AE2: ai_data5 = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 40.0 find_next 1 pass_wrecked 1
            if  not Car.Wrecked(ai_data5)
            then
                09B3: get_car ai_data5 door_status $tempvar_Float_2
                if and
                  not $tempvar_Float_2 == 1
                  not $tempvar_Float_2 == 2
                  not $tempvar_Float_2 == 4
                then  
                    046C: $tempvar_Float_1 = car ai_data5 driver
                    if  Actor.Dead($tempvar_Float_1)
                    then

                        Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                        $tempvar_Float_3 += 4.0
                        if  gosub @ai_can_be_shoot_at_pointfloat
                        then
                            07A1: set_walk_speed 6
                            05CB: AS_actor 0@ enter_car ai_data5 as_driver -1 ms
                            33@ = 0
                            01BD: ai_move_time = current_time_in_ms
                            ai_move_time += 1700
                            goto @bool_return_true
                        end
                    else
                        046C: $tempvar_Float_1 = car ai_data5 driver
                        089F: get_actor $tempvar_Float_1 pedtype_to $tempvar_Float_2
                        089F: get_actor 0@ pedtype_to $tempvar_Float_3
                        if 003B:   $tempvar_Float_2 == $tempvar_Float_3 // (int)  
                        then
                            01E9: $tempvar_Float_2 = car ai_data5 num_passengers 
                            01EA: $tempvar_Float_3 = car ai_data5 max_passengers 
                            if 803B:   $tempvar_Float_2 == $tempvar_Float_3 // (int) 
                            then
                                Car.StorePos(ai_data5, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                                $tempvar_Float_3 += 4.0
                                if  gosub @ai_can_be_shoot_at_pointfloat
                                then
                                    07A1: set_walk_speed 6
                                    //05CA: AS_actor 0@ enter_car ai_data5 passenger_seat -1 time 2000
                                    0430: put_actor 0@ into_car ai_data5 passenger_seat -1

                                    33@ = 0        
                                    01BD: ai_move_time = current_time_in_ms
                                    ai_move_time += 1700
                                    goto @bool_return_true
                                end 
                            end                       
                        end
                    end
                
                end  

            end
        end    
        if  
            special_command == 59
        then
        end
    end // for
    gosub @character_reset_all_animation
    if  gosub @ai_can_be_shoot_at_point
    then
        07A1: set_walk_speed 7
        if
            not Actor.Dead(ai_master_ped)
        then
             if and
                  8597:   actor 0@ crouching
                  0597:   actor ai_master_ped crouching
             then
                 04EB: AS_actor 0@ crouch 1
             end
             if and
                  0597:   actor 0@ crouching
                  8597:   actor ai_master_ped crouching
             then
                 04EB: AS_actor 0@ crouch 0
             end         
         end
         
         
        05D3: AS_actor 0@ goto_point $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 7 time -2 ms 


    else
        07A1: set_walk_speed 7
        if
            not Actor.Dead(ai_master_ped)
        then
             if and
                  8597:   actor 0@ crouching
                  0597:   actor ai_master_ped crouching
             then
                 04EB: AS_actor 0@ crouch 1
             end
             if and
                  0597:   actor 0@ crouching
                  8597:   actor ai_master_ped crouching
             then
                 04EB: AS_actor 0@ crouch 0
             end         
         end
        0603: AS_actor 0@ goto_point_any_means $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 7 use_car -2  
    end
    
    
    if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 10.0 10.0 10.0 
    then
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 500
        return
    end
    if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 20.0 20.0 20.0 
    then
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 1000
        return
    end    
    if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 30.0 30.0 30.0 
    then
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 1500
        return
    end   
    if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 40.0 40.0 40.0 
    then
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 2500
        return
    end     
    if  00FE:   actor 0@ sphere 0 in_sphere $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD radius 50.0 50.0 50.0 
    then
        01BD: ai_move_time = current_time_in_ms
        ai_move_time += 3000
        return
    end     
    01BD: ai_move_time = current_time_in_ms
    ai_move_time += 6000
end    
return








:get_target_angle_now
04C4: store_coords_to 10@ 11@ 12@ from_actor 1@ with_offset 0.0 0.0 0.0 
Actor.StorePos(0@, 13@ 14@ 15@)
0063: 13@ -= 10@ // (float) 
0063: 14@ -= 11@ // (float) 
0604: get_Z_angle_for_point 13@ 14@ store_to 15@ 
15@ += 180.0
0656: get_angle 15@ absolute_degrees_to 15@
0AB2: ret 1 15@
                        
                        
                        
                        
                        
                        
                        




{

if  ai_move_time > 500
jf @bool_return_false
if or  
    function_character_current_task_id == ai_task_firing
    function_character_current_task_id == ai_task_aiming
    function_character_current_task_id ==  function_character_search_shelter_1
    function_character_current_task_id ==  function_character_search_shelter_2
    function_character_current_task_id ==  function_character_search_shelter_3
    function_character_current_task_id ==  function_character_search_shelter_4
then 
    if  gosub @ai_is_around_path_can_not_pass
    then
        if gosub @ai_get_around_path_can_be_pass
        jf @bool_return_false
    end    
    if  gosub @check_character_is_not_reloading
    then
        if  gosub  @check_character_current_wepaon_can_shoot
        then
            //0AB1: call_scm_func @Task_actor_random_move 2 0@ ai_target

            02CE: $TEMPVAR_z_COORD = ground_z_at $TEMPVAR_x_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD
                                                              

   
            if
                not Actor.Dead(ai_target)
            then
                if  gosub @check_target_can_character_shoot
                then
                    if gosub @start_check_can_shoot_at_target_without_friend //?
                    then
                    
                        gosub @character_reset_all_animation 
                        gosub @TAMAI_Awake_weapon_flag_to_rife   
                        0AB1: call_scm_func @get_target_ 2 0@ ai_target
                        
                        //0A1A: actor 0@ perform_walk_animation "GunMove_FWD" IFP "PED" framedelta 4.0 loopA 1 lockX 1 lockY 1 lockF 0 -1 ms // versionC
                        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor ai_target with_offset 0.0 0.0 0.0 
                        Object.StorePos(0@, $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD)
                        0063: $TEMPVAR_X_COORD -= $TEMPVAR_FLOAT_1 // (float) 
                        0063: $TEMPVAR_Y_COORD -= $TEMPVAR_FLOAT_2 // (float) 
                        0604: get_Z_angle_for_point $TEMPVAR_X_COORD $TEMPVAR_Y_COORD store_to $TEMPVAR_FLOAT_1 
                        $TEMPVAR_FLOAT_1 -= 90.0 
                        0656: get_angle $TEMPVAR_FLOAT_1 absolute_degrees_to $TEMPVAR_FLOAT_1
                      
                        
                        0812: AS_actor 0@ perform_animation "GunMove_FWD" IFP "PED" framedelta 1000.0 loopA 1 lockX 1 lockY 1 lockF 0 time 2000  // versionB



                        //0637: AS_actor 0@ go $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 look_at_actor ai_target 
                        ai_move_time = -300
                        gosub @TAMAI_Awake_weapon_flag_to_current_weapon
                    else
                        gosub @character_reset_all_animation
                        gosub @TAMAI_Awake_weapon_flag_to_rife    
                          
                        06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 actor ai_target with_offset 0.0 0.0 0.0
                        ai_move_time = -300
                        gosub @TAMAI_Awake_weapon_flag_to_current_weapon                    
                    end
                    
                else     
                    gosub @character_reset_all_animation
                    gosub @TAMAI_Awake_weapon_flag_to_rife      
                    06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 actor ai_target with_offset 0.0 0.0 0.0
                    
                    ai_move_time = -300
                    gosub @TAMAI_Awake_weapon_flag_to_current_weapon
                end  
            else
                gosub @character_reset_all_animation
                gosub @TAMAI_Awake_weapon_flag_to_rife 
                04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_actor 0@ with_offset 2.0 16.0 1.0                     
                06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 0.5 actor -1 with_offset $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3
                ai_move_time = -700
                gosub @TAMAI_Awake_weapon_flag_to_current_weapon
            end   
            
}



0812: AS_actor 0@ perform_animation "FightA_2" IFP "PED" framedelta 8.0 loopA 1 lockX 1 lockY 1 lockF 1 time -1  // versionB

:character_reset_all_animation
//0ACE: show_formatted_text_box "Actor.tasksystem.clean.fromIndex(index.all)" 0x0ACE
06C9: remove_actor 0@ from_group
if and
    not Actor.Driving(0@)
    8965:  not actor 0@ swimming
    8A32:  actor 0@ on_turret_of_car
then
     if 
        0597:   actor 0@ crouching
     then
        0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@
        0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@
         04EB: AS_actor 0@ crouch 1
    else
                0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@
        0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@
     end    


else
    0687: clear_actor 0@ task  
end
return


:character_reset_all_animation_no_crouch 
//0ACE: show_formatted_text_box "Actor.tasksystem.clean.fromIndex(index.all)" 0x0ACE
06C9: remove_actor 0@ from_group
if and
    not Actor.Driving(0@)
    8965:  not actor 0@ swimming
    8A32:  actor 0@ on_turret_of_car
then
                0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@
        0687: clear_actor 0@ task
        0792: disembark_instantly_actor 0@

else
    0687: clear_actor 0@ task  
end
return

:clean_actor
0470: 10@ = actor 0@ current_weapon
01B9: set_actor 0@ armed_weapon_to 0 
06C2: AS_actor 0@ goto 0.0 0.0 0.0 mode 4 turn_radius 1.0 stop_radius 1.0 actor 0@ with_offset 0.0 0.0 0.0
0792: disembark_instantly_actor 0@
01B9: set_actor 0@ armed_weapon_to 10@

0AB2: ret 0

:Task_actor_random_move
0209: $TEMPVAR_FLOAT_3 = random_int_in_ranges 0 4
if  $TEMPVAR_FLOAT_3 == 0
then
    $TEMPVAR_FLOAT_1 = 3.0
    $TEMPVAR_FLOAT_2 = 0.0
end
if  $TEMPVAR_FLOAT_3 == 1
then
    $TEMPVAR_FLOAT_1 = -3.0
    $TEMPVAR_FLOAT_2 = 0.0
end
if  $TEMPVAR_FLOAT_3 == 2
then
    $TEMPVAR_FLOAT_1 = 3.0
    $TEMPVAR_FLOAT_2 = -3.0
end            
if  $TEMPVAR_FLOAT_3 == 3
then
    $TEMPVAR_FLOAT_1 = -3.0
    $TEMPVAR_FLOAT_2 = -3.0
end
Actor.StorePos(0@, 10@, 11@, 12@)
005B: 10@ += $TEMPVAR_FLOAT_1  // (float)
005B: 11@ += $TEMPVAR_FLOAT_2  // (float)
gosub @character_reset_all_animation 
if
    not Actor.Dead(1@)
then
    0637: AS_actor 0@ go $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 1.0 look_at_actor 1@  
else
    04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_actor 0@ with_offset 2.0 16.0 1.0                     
    06C2: AS_actor 0@ goto $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD mode 6 turn_radius 0.5 stop_radius 0.5 actor -1 with_offset $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3
end   
0AB2: ret 0



const
     target_index = ai_data4
     myself_index = ai_data5
     next_index = ai_data6
     show_cube = 0
     index_line = ai_data1
     line_radius = ai_data2
end // const




:TAMAI_Awake_weapon_flag_to_rife

0470: ai_data4 = actor 0@ current_weapon 
if and                                                           
  ai_data4 >= 33 
  ai_data4 <= 38
then
    if 8491:   actor 0@ has_weapon 31
    then
        if  not Model.Available(#M4)
        then
            Model.Load(#M4)
            038B: load_requested_models
        end
        Actor.GiveWeaponAndAmmo(0@, 31, 1)
        ai_data6 = 100
    else
        ai_data6 = 200
    end
    01B9: set_actor 0@ armed_weapon_to 31
    return
else

    
end
0470: ai_data4 = actor 0@ current_weapon 
if or                                                        
  ai_data4 == 28 
  ai_data4 == 32
  ai_data4 == 22
then
    if  8491:   actor 0@ has_weapon 31
    then
        if  not Model.Available(#M4)
        then
            Model.Load(#M4)
            038B: load_requested_models
        end
        Actor.GiveWeaponAndAmmo(0@, 31, 1)
        ai_data6 = 100
    else
        ai_data6 = 200
    end
    01B9: set_actor 0@ armed_weapon_to 31
    return
end
return

:TAMAI_Awake_weapon_flag_to_current_weapon
if or
  ai_data6 == 100
  ai_data6 == 200
then
    wait 0
    gosub @check_character_defined  
    gosub @function_character_set_animation_rate
    gosub @read_external_script_command_01
    if
    056D:   actor 0@ defined
    then
        if  not Actor.Dead(0@)
        then
            01B9: set_actor 0@ armed_weapon_to ai_data4
        end
    end
end
ai_data6 = -7
return



:start_check_can_shoot_at_target_without_friend
089F: get_actor 0@ pedtype_to $TEMPVAR_FLOAT_1
if or
    ai_group_type == group_friend
    ai_group_type == group_familly
    $TEMPVAR_FLOAT_1 == 26
    003B:   ai_master_ped == $Player_Actor
jf @bool_return_true
if and  
    
    056D:   actor ai_target defined
    803B: not  ai_target == $PLAYER_ACTOR  // (int)
then
    if  not Actor.Dead(ai_target)
    then
        if  8104:  not actor $PLAYER_ACTOR near_actor ai_target radius 1.7 1.7 1.7 sphere 0
        jf @bool_return_true
    end
end     
for ai_data4 = 1 to 60 // step 1
   0093: ai_data6 = integer ai_data4 to_float
   if and
       02A0:   actor $PLAYER_ACTOR stopped
       02A0:   actor 0@ stopped
   then
        $TEMPVAR_ANGLE = 0.6
   else
        $TEMPVAR_ANGLE = 1.2
   end
   04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3  from_actor 0@ with_offset 0.0 ai_data6 0.0
   if 80FE: not actor $PLAYER_ACTOR sphere 0 in_sphere $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 radius $TEMPVAR_ANGLE $TEMPVAR_ANGLE 100.0
   jf @bool_return_false  
end // for
goto @bool_return_true





:check_target_can_character_shoot
0889: store_actor 0@ center_of_body_position_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3

0889: store_actor ai_target center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true  
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset 0.0 0.0 0.5 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true 
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset -0.5 0.0 0.0 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset 0.5 0.0 0.0 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_actor 0@ with_offset 0.0 0.0 0.92


0889: store_actor ai_target center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true  
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset 0.0 0.0 0.5 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true 
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset -0.5 0.0 0.0 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset 0.5 0.0 0.0 
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
if  89ED:   not actor 0@ is_within_field_of_view_actor ai_target
jf @bool_return_true

goto @bool_return_false





:ai_can_be_shoot_at_point
0889: store_actor 0@ center_of_body_position_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3  
if 86BD:   no_obstacles_between $TEMPVAR_X_COORD $TEMPVAR_y_COORD $TEMPVAR_z_COORD and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
goto @bool_return_false

:ai_can_be_shoot_at_pointfloat
0889: store_actor 0@ center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
goto @bool_return_false

:ai_can_go_to_pointfloat
0889: store_actor 0@ center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 1 actor 0 object 1 particle 0 
jf @bool_return_true
goto @bool_return_false

:ai_target_can_go_to_pointfloat2
0889: store_actor ai_target center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 1 actor 0 object 1 particle 0 
jf @bool_return_true
goto @bool_return_false

:ai_target_can_go_to_pointfloat
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor ai_target with_offset 0.0 0.0 1.0
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 1 actor 0 object 1 particle 0 
jf @bool_return_true
goto @bool_return_false


:ai_trarget_can_be_shoot_at_pointfloat
0889: store_actor ai_target center_of_body_position_to ai_data1 ai_data2 ai_data3
if 86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3   solid 1 car 0 actor 0 object 0 particle 0 
jf @bool_return_true
goto @bool_return_false


//$TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD store_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 Z_angle_to $TEMPVAR_ANGLE
:ai_is_around_path_can_not_pass
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 1.5 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    goto @bool_return_true
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -1.5 0.35 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    goto @bool_return_true
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 -1.5 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    goto @bool_return_true
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 1.5 0.35 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    goto @bool_return_true
end
goto @bool_return_false

:ai_get_around_path_can_be_pass
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 1.5 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then      
    0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -25 3000
    if  $TEMPVAR_FLOAT_1 < 0
    then
        04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -1.5 0.35 0.35
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
        if 
        06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
        then
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset -1.5 0.0 0.0
            goto @bool_return_true
        end
    end
    04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 1.5 0.35 0.35
    04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
    if 
    06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
    then
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 1.5 0.0 0.0
        goto @bool_return_true
    end    
    goto @bool_return_false
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -1.5 0.35 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -25 3000
    if  $TEMPVAR_FLOAT_1 < 0
    then
        04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 1.5 0.35
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
        if 
        06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
        then
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 0.0 1.5 0.0
            goto @bool_return_true
        end
    end
    04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -0.35 -1.5 0.35
    04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.35 0.0 -0.35
    if 
    06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
    then
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 0.0 -1.5 0.0
        goto @bool_return_true
    end    
    goto @bool_return_false
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 -1.5 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -25 3000
    if  $TEMPVAR_FLOAT_1 < 0
    then
        04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -1.5 0.35 0.35
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
        if 
        06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
        then
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset -1.5 0.0 0.0
            goto @bool_return_true
        end
    end
    04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 1.5 0.35 0.35
    04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
    if 
    06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
    then
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 1.5 0.0 0.0
        goto @bool_return_true
    end    
    goto @bool_return_false
end
04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 1.5 0.35 0.35
04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.0 -0.35 -0.35
if 
86BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
then
    0209: $TEMPVAR_FLOAT_1 = random_int_in_ranges -25 3000
    if  $TEMPVAR_FLOAT_1 < 0
    then
        04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset 0.35 1.5 0.35
        04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset -0.35 0.0 -0.35
        if 
        06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
        then
            04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 0.0 1.5 0.0
            goto @bool_return_true
        end
    end
    04C4: store_coords_to ai_data1 ai_data2 ai_data3 from_actor 0@ with_offset -0.35 -1.5 0.35
    04C4: store_coords_to $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 from_actor 0@ with_offset 0.35 0.0 -0.35
    if 
    06BD:   no_obstacles_between ai_data1 ai_data2 ai_data3 and $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 $TEMPVAR_FLOAT_3 solid 1 car 1 actor 0 object 1 particle 0 
    then
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR__COORD  from_actor 0@ with_offset 0.0 -1.5 0.0
        goto @bool_return_true
    end    
    goto @bool_return_false
end
goto @bool_return_false




:check_character_current_wepaon_can_shoot
0470: $tempvar_Float_1 = actor 0@ current_weapon 
if and                                                            
   $tempvar_Float_1 > 18
   $tempvar_Float_1 < 39
jf @bool_return_false
goto @bool_return_true


:read_external_script_command_01
if  ai_taskpack == -2
then
    0A8D: $TEMPVAR_X_COORD = read_memory 9867536 size 2 virtual_protect 1  
    if  
    04A4:    $TEMPVAR_X_COORD == 0x5834
    then
         3@ = -1
         20@ = -1
         gosub @character_reset_all_animation
         03E5: show_text_box 'CFR_3' 
         wait 250
         0A8C: write_memory 9867536 size 4 value 0 virtual_protect 1
    END
    if  
    04A4:    $TEMPVAR_X_COORD == 0x5833
    then
        gosub @character_reset_all_animation
        0208: $TEMPVAR_FLOAT_1 = random_float_in_ranges -1.0 1.0
        0208: $TEMPVAR_FLOAT_2 = random_float_in_ranges 0.0 1.5
        $TEMPVAR_FLOAT_1 *= 1.5
        $TEMPVAR_FLOAT_2 *= 1.5
        077E: get_active_interior_to $TEMPVAR_Z_COORD
        0860: link_actor 0@ to_interior $TEMPVAR_Z_COORD    
        04C4: store_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD from_actor $PLAYER_ACTOR with_offset $TEMPVAR_FLOAT_1 $TEMPVAR_FLOAT_2 0.0
        0972: put_actor 0@ at $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD no_offset 
         wait 250
         0A8C: write_memory 9867536 size 4 value 0 virtual_protect 1
    END
    if  
    04A4:    $TEMPVAR_X_COORD == 0x5835
    then
         wait 250
         0A8C: write_memory 9867536 size 4 value 0 virtual_protect 1
         if special_command == 59
         then
            special_command = 0
             33@ = 1000000
             0ACE: show_formatted_text_box "Clever npcs: AI has stopped going to target point." 0x0ACE         
         else
             0AB6: store_target_marker_coords_to $TEMPVAR_X_COORD $TEMPVAR_Y_COORD $TEMPVAR_Z_COORD // IF and SET
             if and
                not $TEMPVAR_X_COORD = 0.0
                not $TEMPVAR_X_COORD = 0
             then
                 special_command = 59
                 33@ = 1000000
                 0ACE: show_formatted_text_box "Clever npcs: Go to player target point." 0x0ACE
            else
                 0ACE: show_formatted_text_box "Clever npcs: Please select a target point." 0x0ACE
             end
         end



    END
    if or
        04A4:    $TEMPVAR_X_COORD == 0x5832
        04A4:    $TEMPVAR_X_COORD == 0x5836
    then
        if not Actor.Driving($PLAYER_ACTOR)
        then
            if  0AD2: $TEMPVAR_X_COORD = player $PLAYER_CHAR targeted_actor //IF and SET
            then
                if  056D:   actor $TEMPVAR_X_COORD defined
                then
                    089F: get_actor $TEMPVAR_X_COORD pedtype_to 3@
                    03E5: show_text_box 'CFR_2'
                     wait 250
                     0A8C: write_memory 9867536 size 4 value 0 virtual_protect 1
                end
            else
      
            end
        else
            for $TEMPVAR_z_COORD = 0 to 20 // step 1
                04C4: store_coords_to $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 from_actor $Player_Actor with_offset 0.0 7.0 0.0 
                0AE2: $TEMPVAR_X_COORD = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 7.0 find_next 1 pass_wrecked 1 //IF and SET 
                if  not car.Wrecked($TEMPVAR_X_COORD)
                then
                    if  not Actor.InCar($PLAYER_ACTOR, $TEMPVAR_X_COORD)
                    then
                        046C: $TEMPVAR_Y_COORD = car $TEMPVAR_X_COORD driver
                        if  not $TEMPVAR_Y_COORD == -1
                        then 
                            089F: get_actor $TEMPVAR_Y_COORD pedtype_to 3@
                            03E5: show_text_box 'CFR_4' 
                             wait 250
                             0A8C: write_memory 9867536 size 4 value 0 virtual_protect 1
                        end
                    end
                end    
            end // for
     
        end
    end 
    $TEMPVAR_X_COORD = 0.0
end
return


:TAMAI
gosub @TAMAI_Awake
gosub @TAMAI_Update
goto @function_remove_this_ai_script 












:TAMAI_Global_Start_Thread
if
    0@ == 0
then
    0ADF: add_dynamic_GXT_entry "aidebug" text "AI.getReturn[(~1~), (~1~), (~1~), (~1~)]"
    while true
        wait 0

        if
        0ADC:   test_cheat "addf"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype 4 enemytype group_friend followped $PLAYER_ACTOR taskpack 0
             0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
        end
        if
        0ADC:   test_cheat "adde"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype 4 enemytype group_enemy1 followped -1 taskpack 0
             0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
        end    
        if
        0ADC:   test_cheat "addp"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype 4 enemytype group_police followped -1 taskpack 0     
             0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
        end   
        if
        0ADC:   test_cheat "addsf"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype ai_type_stayer enemytype group_friend followped -1 taskpack 0
             0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
        end
        if
        0ADC:   test_cheat "addkf"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype 4 enemytype group_friend followped -1 taskpack 0
             0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
        end   
        if
        0ADC:   test_cheat "addt"
        then
             0AD2: $TEMPVAR_ACTOR_CAR = player $PLAYER_CHAR targeted_actor //IF and SET
             if not $TEMPVAR_ACTOR_CAR == -1
             then
                10@ = -1
                for 14@ = 0 to 200 // step 1
                    Actor.StorePos($Player_Actor, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                    0AE2: 16@ = random_vehicle_near_point $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 in_radius 10000.0 find_next 1 pass_wrecked 1 //IF and SET 
                    if 
                    056E:   car 16@ defined 
                    then
                        if
                           Car.Wrecked(10@)
                        then
                            Actor.StorePos($Player_Actor, $tempvar_X_coord, $tempvar_Y_coord, $tempvar_Z_coord)
                            Car.StorePos(16@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                            050A: 11@ = distance_between_XYZ $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 and_XYZ $tempvar_X_coord $tempvar_Y_coord $tempvar_Z_coord
                            0085: 12@ = 11@ 
                            0085: 10@ = 16@
                        else
                             Actor.StorePos($Player_Actor, $tempvar_X_coord, $tempvar_Y_coord, $tempvar_Z_coord)
                             Car.StorePos(16@, $tempvar_Float_1, $tempvar_Float_2, $tempvar_Float_3)
                             050A: 11@ = distance_between_XYZ $tempvar_Float_1 $tempvar_Float_2 $tempvar_Float_3 and_XYZ $tempvar_X_coord $tempvar_Y_coord $tempvar_Z_coord
                             if
                             0025:   12@ > 11@  // (float)
                             then
                                 0085: 12@ = 11@ 
                                 0085: 10@ = 16@               
                             end        
                        end
                    end
                end
                if not Car.Wrecked(10@)
                then
                    0792: disembark_instantly_actor $TEMPVAR_ACTOR_CAR
                     072A: put_actor $TEMPVAR_ACTOR_CAR into_car 10@ driverseat
                     0ACE: show_formatted_text_box "Cheat activated: ~n~Put into nearest car."
                else
                    0ACE: show_formatted_text_box "Error: ~n~There isn't any car around you ."
                end
    
                 0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI $TEMPVAR_ACTOR_CAR cleantype never_clean aitype 4 enemytype group_police followped -1 taskpack 0 
                 0ACE: show_formatted_text_box "AI SYSTEM: an AI script has added at your target"
             end
        end 
        
        
        
        if  0ADC:   test_cheat "AIAB"
        then
            0ACE: show_formatted_text_box "AI SCRIPT:~N~Script by Tamcl~n~newtamcl(a)foxmail.com~N~~Y~Current Version: BETA 0.9" 0x0ACE
        
        end

    end // while
end
0AB1: call_scm_func @add_game_event_listener 7 @call_function_server_new_AIAPI 0@ 1@ 2@ 3@ 4@ 5@
0A93: end_custom_thread
end_thread

:call_function_server_new_AIAPI
gosub @TAMAI_Awake
gosub @TAMAI_Update
goto @function_remove_this_ai_script 
 


:add_game_event_listener
0A9F: 32@ = current_thread_pointer
32@ += 0x10
0A8D: 32@ = read_memory 32@ size 4 virtual_protect 0
0062: 32@ -= 0@
0AA7: call_function 0x464C20 num_params 1 pop 1 32@ 33@
005A: 32@ += 0@
33@ += 0x10
0A8C: write_memory 33@ size 4 value 32@ virtual_protect 0
33@ += 0xB7
0A8C: write_memory 33@ size 1 value 0x1 virtual_protect 0
33@ += 0x2
0A8C: write_memory 33@ size 1 value 0x1 virtual_protect 0
33@ -= 0x8D
for 32@ = 0 to 30
    0A8C: write_memory 33@ size 4 value 1@(32@,1i) virtual_protect 0
    33@ += 0x4
end
0AB2: ret 0